1. initialize_edges
2. process_edge_bms_pair, map_to_internal_bms