#
# PostgreSQL top level makefile
#
# $Header: /cvsroot/pgsql/GNUmakefile.in,v 1.4 2000/06/11 18:43:52 tgl Exp $
#

srcdir = @srcdir@
VPATH = @srcdir@

top_srcdir = @top_srcdir@
top_builddir = .


all:
	$(MAKE) -C src all
	@echo "All of PostgreSQL successfully made. Ready to install."

install:
	$(MAKE) -C src install
	@cat $(srcdir)/register.txt

clean:
	$(MAKE) -C src clean

distclean:
	-$(MAKE) -C src distclean
	-rm -f config.cache config.log config.status GNUmakefile


.PHONY: all install clean distclean


AUTOCONF = @AUTOCONF@
ACLOCAL = @ACLOCAL@

GNUmakefile: GNUmakefile.in $(top_builddir)/config.status
	CONFIG_FILES=$@ CONFIG_HEADERS= ./config.status

# This rule does not work --- what if config.status doesn't exist?

# $(top_builddir)/config.status: $(top_srcdir)/configure
# 	cd $(top_builddir) && ./config.status --recheck

# These dependencies are evil and dangerous, because they can cause make
# to re-run autoconf and then re-run configure due to configure not
# having a newer timestamp than configure.in after a CVS pull.  Same
# problem for aclocal timestamp skew.  This solution is considerably
# worse than the problem it was intended to solve.
# Do not put it back or I will take it right out again --- tgl

# $(top_srcdir)/configure: $(top_srcdir)/configure.in $(top_srcdir)/aclocal.m4
# 	cd $(top_srcdir) && $(AUTOCONF)

# $(top_srcdir)/aclocal.m4: $(wildcard $(top_srcdir)/config/*.m4)
# 	cd $(top_srcdir) && $(ACLOCAL) -I config
