--
-- TIMESTAMPTZ
--
CREATE TABLE TIMESTAMPTZ_TBL (d1 timestamp(2) with time zone);
-- Test shorthand input values
-- We can't just "select" the results since they aren't constants; test for
-- equality instead.  We can do that by running the test inside a transaction
-- block, within which the value of 'now' shouldn't change.  We also check
-- that 'now' *does* change over a reasonable interval such as 100 msec.
-- NOTE: it is possible for this part of the test to fail if the transaction
-- block is entered exactly at local midnight; then 'now' and 'today' have
-- the same values and the counts will come out different.
INSERT INTO TIMESTAMPTZ_TBL VALUES ('now');
SELECT pg_sleep(0.1);
 pg_sleep 
----------
 
(1 row)

BEGIN;
INSERT INTO TIMESTAMPTZ_TBL VALUES ('now');
INSERT INTO TIMESTAMPTZ_TBL VALUES ('today');
INSERT INTO TIMESTAMPTZ_TBL VALUES ('yesterday');
INSERT INTO TIMESTAMPTZ_TBL VALUES ('tomorrow');
INSERT INTO TIMESTAMPTZ_TBL VALUES ('tomorrow EST');
INSERT INTO TIMESTAMPTZ_TBL VALUES ('tomorrow zulu');
SELECT count(*) AS One FROM TIMESTAMPTZ_TBL WHERE d1 = timestamp with time zone 'today';
 one 
-----
   1
(1 row)

SELECT count(*) AS One FROM TIMESTAMPTZ_TBL WHERE d1 = timestamp with time zone 'tomorrow';
 one 
-----
   1
(1 row)

SELECT count(*) AS One FROM TIMESTAMPTZ_TBL WHERE d1 = timestamp with time zone 'yesterday';
 one 
-----
   1
(1 row)

SELECT count(*) AS One FROM TIMESTAMPTZ_TBL WHERE d1 = timestamp(2) with time zone 'now';
 one 
-----
   1
(1 row)

COMMIT;
DELETE FROM TIMESTAMPTZ_TBL;
-- verify uniform transaction time within transaction block
BEGIN;
INSERT INTO TIMESTAMPTZ_TBL VALUES ('now');
SELECT pg_sleep(0.1);
 pg_sleep 
----------
 
(1 row)

INSERT INTO TIMESTAMPTZ_TBL VALUES ('now');
SELECT pg_sleep(0.1);
 pg_sleep 
----------
 
(1 row)

SELECT count(*) AS two FROM TIMESTAMPTZ_TBL WHERE d1 = timestamp(2) with time zone 'now';
 two 
-----
   2
(1 row)

COMMIT;
DELETE FROM TIMESTAMPTZ_TBL;
-- Special values
INSERT INTO TIMESTAMPTZ_TBL VALUES ('-infinity');
INSERT INTO TIMESTAMPTZ_TBL VALUES ('infinity');
INSERT INTO TIMESTAMPTZ_TBL VALUES ('epoch');
-- Obsolete special values
INSERT INTO TIMESTAMPTZ_TBL VALUES ('invalid');
ERROR:  date/time value "invalid" is no longer supported
LINE 1: INSERT INTO TIMESTAMPTZ_TBL VALUES ('invalid');
                                            ^
INSERT INTO TIMESTAMPTZ_TBL VALUES ('undefined');
ERROR:  date/time value "undefined" is no longer supported
LINE 1: INSERT INTO TIMESTAMPTZ_TBL VALUES ('undefined');
                                            ^
INSERT INTO TIMESTAMPTZ_TBL VALUES ('current');
ERROR:  date/time value "current" is no longer supported
LINE 1: INSERT INTO TIMESTAMPTZ_TBL VALUES ('current');
                                            ^
-- Postgres v6.0 standard output format
INSERT INTO TIMESTAMPTZ_TBL VALUES ('Mon Feb 10 17:32:01 1997 PST');
-- Variations on Postgres v6.1 standard output format
INSERT INTO TIMESTAMPTZ_TBL VALUES ('Mon Feb 10 17:32:01.000001 1997 PST');
INSERT INTO TIMESTAMPTZ_TBL VALUES ('Mon Feb 10 17:32:01.999999 1997 PST');
INSERT INTO TIMESTAMPTZ_TBL VALUES ('Mon Feb 10 17:32:01.4 1997 PST');
INSERT INTO TIMESTAMPTZ_TBL VALUES ('Mon Feb 10 17:32:01.5 1997 PST');
INSERT INTO TIMESTAMPTZ_TBL VALUES ('Mon Feb 10 17:32:01.6 1997 PST');
-- ISO 8601 format
INSERT INTO TIMESTAMPTZ_TBL VALUES ('1997-01-02');
INSERT INTO TIMESTAMPTZ_TBL VALUES ('1997-01-02 03:04:05');
INSERT INTO TIMESTAMPTZ_TBL VALUES ('1997-02-10 17:32:01-08');
INSERT INTO TIMESTAMPTZ_TBL VALUES ('1997-02-10 17:32:01-0800');
INSERT INTO TIMESTAMPTZ_TBL VALUES ('1997-02-10 17:32:01 -08:00');
INSERT INTO TIMESTAMPTZ_TBL VALUES ('19970210 173201 -0800');
INSERT INTO TIMESTAMPTZ_TBL VALUES ('1997-06-10 17:32:01 -07:00');
INSERT INTO TIMESTAMPTZ_TBL VALUES ('2001-09-22T18:19:20');
-- POSIX format (note that the timezone abbrev is just decoration here)
INSERT INTO TIMESTAMPTZ_TBL VALUES ('2000-03-15 08:14:01 GMT+8');
INSERT INTO TIMESTAMPTZ_TBL VALUES ('2000-03-15 13:14:02 GMT-1');
INSERT INTO TIMESTAMPTZ_TBL VALUES ('2000-03-15 12:14:03 GMT-2');
INSERT INTO TIMESTAMPTZ_TBL VALUES ('2000-03-15 03:14:04 PST+8');
INSERT INTO TIMESTAMPTZ_TBL VALUES ('2000-03-15 02:14:05 MST+7:00');
-- Variations for acceptable input formats
INSERT INTO TIMESTAMPTZ_TBL VALUES ('Feb 10 17:32:01 1997 -0800');
INSERT INTO TIMESTAMPTZ_TBL VALUES ('Feb 10 17:32:01 1997');
INSERT INTO TIMESTAMPTZ_TBL VALUES ('Feb 10 5:32PM 1997');
INSERT INTO TIMESTAMPTZ_TBL VALUES ('1997/02/10 17:32:01-0800');
INSERT INTO TIMESTAMPTZ_TBL VALUES ('1997-02-10 17:32:01 PST');
INSERT INTO TIMESTAMPTZ_TBL VALUES ('Feb-10-1997 17:32:01 PST');
INSERT INTO TIMESTAMPTZ_TBL VALUES ('02-10-1997 17:32:01 PST');
INSERT INTO TIMESTAMPTZ_TBL VALUES ('19970210 173201 PST');
set datestyle to ymd;
INSERT INTO TIMESTAMPTZ_TBL VALUES ('97FEB10 5:32:01PM UTC');
INSERT INTO TIMESTAMPTZ_TBL VALUES ('97/02/10 17:32:01 UTC');
reset datestyle;
INSERT INTO TIMESTAMPTZ_TBL VALUES ('1997.041 17:32:01 UTC');
-- timestamps at different timezones
INSERT INTO TIMESTAMPTZ_TBL VALUES ('19970210 173201 America/New_York');
SELECT '19970210 173201' AT TIME ZONE 'America/New_York';
         timezone         
--------------------------
 Mon Feb 10 20:32:01 1997
(1 row)

INSERT INTO TIMESTAMPTZ_TBL VALUES ('19970710 173201 America/New_York');
SELECT '19970710 173201' AT TIME ZONE 'America/New_York';
         timezone         
--------------------------
 Thu Jul 10 20:32:01 1997
(1 row)

INSERT INTO TIMESTAMPTZ_TBL VALUES ('19970710 173201 America/Does_not_exist');
ERROR:  time zone "america/does_not_exist" not recognized
LINE 1: INSERT INTO TIMESTAMPTZ_TBL VALUES ('19970710 173201 America...
                                            ^
SELECT '19970710 173201' AT TIME ZONE 'America/Does_not_exist';
ERROR:  time zone "America/Does_not_exist" not recognized
-- Daylight saving time for timestamps beyond 32-bit time_t range.
SELECT '20500710 173201 Europe/Helsinki'::timestamptz; -- DST
         timestamptz          
------------------------------
 Sun Jul 10 07:32:01 2050 PDT
(1 row)

SELECT '20500110 173201 Europe/Helsinki'::timestamptz; -- non-DST
         timestamptz          
------------------------------
 Mon Jan 10 07:32:01 2050 PST
(1 row)

SELECT '205000-07-10 17:32:01 Europe/Helsinki'::timestamptz; -- DST
          timestamptz           
--------------------------------
 Thu Jul 10 07:32:01 205000 PDT
(1 row)

SELECT '205000-01-10 17:32:01 Europe/Helsinki'::timestamptz; -- non-DST
          timestamptz           
--------------------------------
 Fri Jan 10 07:32:01 205000 PST
(1 row)

-- Check date conversion and date arithmetic
INSERT INTO TIMESTAMPTZ_TBL VALUES ('1997-06-10 18:32:01 PDT');
INSERT INTO TIMESTAMPTZ_TBL VALUES ('Feb 10 17:32:01 1997');
INSERT INTO TIMESTAMPTZ_TBL VALUES ('Feb 11 17:32:01 1997');
INSERT INTO TIMESTAMPTZ_TBL VALUES ('Feb 12 17:32:01 1997');
INSERT INTO TIMESTAMPTZ_TBL VALUES ('Feb 13 17:32:01 1997');
INSERT INTO TIMESTAMPTZ_TBL VALUES ('Feb 14 17:32:01 1997');
INSERT INTO TIMESTAMPTZ_TBL VALUES ('Feb 15 17:32:01 1997');
INSERT INTO TIMESTAMPTZ_TBL VALUES ('Feb 16 17:32:01 1997');
INSERT INTO TIMESTAMPTZ_TBL VALUES ('Feb 16 17:32:01 0097 BC');
INSERT INTO TIMESTAMPTZ_TBL VALUES ('Feb 16 17:32:01 0097');
INSERT INTO TIMESTAMPTZ_TBL VALUES ('Feb 16 17:32:01 0597');
INSERT INTO TIMESTAMPTZ_TBL VALUES ('Feb 16 17:32:01 1097');
INSERT INTO TIMESTAMPTZ_TBL VALUES ('Feb 16 17:32:01 1697');
INSERT INTO TIMESTAMPTZ_TBL VALUES ('Feb 16 17:32:01 1797');
INSERT INTO TIMESTAMPTZ_TBL VALUES ('Feb 16 17:32:01 1897');
INSERT INTO TIMESTAMPTZ_TBL VALUES ('Feb 16 17:32:01 1997');
INSERT INTO TIMESTAMPTZ_TBL VALUES ('Feb 16 17:32:01 2097');
INSERT INTO TIMESTAMPTZ_TBL VALUES ('Feb 28 17:32:01 1996');
INSERT INTO TIMESTAMPTZ_TBL VALUES ('Feb 29 17:32:01 1996');
INSERT INTO TIMESTAMPTZ_TBL VALUES ('Mar 01 17:32:01 1996');
INSERT INTO TIMESTAMPTZ_TBL VALUES ('Dec 30 17:32:01 1996');
INSERT INTO TIMESTAMPTZ_TBL VALUES ('Dec 31 17:32:01 1996');
INSERT INTO TIMESTAMPTZ_TBL VALUES ('Jan 01 17:32:01 1997');
INSERT INTO TIMESTAMPTZ_TBL VALUES ('Feb 28 17:32:01 1997');
INSERT INTO TIMESTAMPTZ_TBL VALUES ('Feb 29 17:32:01 1997');
ERROR:  date/time field value out of range: "Feb 29 17:32:01 1997"
LINE 1: INSERT INTO TIMESTAMPTZ_TBL VALUES ('Feb 29 17:32:01 1997');
                                            ^
INSERT INTO TIMESTAMPTZ_TBL VALUES ('Mar 01 17:32:01 1997');
INSERT INTO TIMESTAMPTZ_TBL VALUES ('Dec 30 17:32:01 1997');
INSERT INTO TIMESTAMPTZ_TBL VALUES ('Dec 31 17:32:01 1997');
INSERT INTO TIMESTAMPTZ_TBL VALUES ('Dec 31 17:32:01 1999');
INSERT INTO TIMESTAMPTZ_TBL VALUES ('Jan 01 17:32:01 2000');
INSERT INTO TIMESTAMPTZ_TBL VALUES ('Dec 31 17:32:01 2000');
INSERT INTO TIMESTAMPTZ_TBL VALUES ('Jan 01 17:32:01 2001');
-- Currently unsupported syntax and ranges
INSERT INTO TIMESTAMPTZ_TBL VALUES ('Feb 16 17:32:01 -0097');
ERROR:  time zone displacement out of range: "Feb 16 17:32:01 -0097"
LINE 1: INSERT INTO TIMESTAMPTZ_TBL VALUES ('Feb 16 17:32:01 -0097')...
                                            ^
INSERT INTO TIMESTAMPTZ_TBL VALUES ('Feb 16 17:32:01 5097 BC');
ERROR:  timestamp out of range: "Feb 16 17:32:01 5097 BC"
LINE 1: INSERT INTO TIMESTAMPTZ_TBL VALUES ('Feb 16 17:32:01 5097 BC...
                                            ^
-- Alternative field order that we've historically supported (sort of)
-- with regular and POSIXy timezone specs
SELECT 'Wed Jul 11 10:51:14 America/New_York 2001'::timestamptz;
         timestamptz          
------------------------------
 Wed Jul 11 07:51:14 2001 PDT
(1 row)

SELECT 'Wed Jul 11 10:51:14 GMT-4 2001'::timestamptz;
         timestamptz          
------------------------------
 Tue Jul 10 23:51:14 2001 PDT
(1 row)

SELECT 'Wed Jul 11 10:51:14 GMT+4 2001'::timestamptz;
         timestamptz          
------------------------------
 Wed Jul 11 07:51:14 2001 PDT
(1 row)

SELECT 'Wed Jul 11 10:51:14 PST-03:00 2001'::timestamptz;
         timestamptz          
------------------------------
 Wed Jul 11 00:51:14 2001 PDT
(1 row)

SELECT 'Wed Jul 11 10:51:14 PST+03:00 2001'::timestamptz;
         timestamptz          
------------------------------
 Wed Jul 11 06:51:14 2001 PDT
(1 row)

SELECT '' AS "64", d1 FROM TIMESTAMPTZ_TBL;
 64 |               d1                
----+---------------------------------
    | -infinity
    | infinity
    | Wed Dec 31 16:00:00 1969 PST
    | Mon Feb 10 17:32:01 1997 PST
    | Mon Feb 10 17:32:01 1997 PST
    | Mon Feb 10 17:32:02 1997 PST
    | Mon Feb 10 17:32:01.4 1997 PST
    | Mon Feb 10 17:32:01.5 1997 PST
    | Mon Feb 10 17:32:01.6 1997 PST
    | Thu Jan 02 00:00:00 1997 PST
    | Thu Jan 02 03:04:05 1997 PST
    | Mon Feb 10 17:32:01 1997 PST
    | Mon Feb 10 17:32:01 1997 PST
    | Mon Feb 10 17:32:01 1997 PST
    | Mon Feb 10 17:32:01 1997 PST
    | Tue Jun 10 17:32:01 1997 PDT
    | Sat Sep 22 18:19:20 2001 PDT
    | Wed Mar 15 08:14:01 2000 PST
    | Wed Mar 15 04:14:02 2000 PST
    | Wed Mar 15 02:14:03 2000 PST
    | Wed Mar 15 03:14:04 2000 PST
    | Wed Mar 15 01:14:05 2000 PST
    | Mon Feb 10 17:32:01 1997 PST
    | Mon Feb 10 17:32:01 1997 PST
    | Mon Feb 10 17:32:00 1997 PST
    | Mon Feb 10 17:32:01 1997 PST
    | Mon Feb 10 17:32:01 1997 PST
    | Mon Feb 10 17:32:01 1997 PST
    | Mon Feb 10 17:32:01 1997 PST
    | Mon Feb 10 17:32:01 1997 PST
    | Mon Feb 10 09:32:01 1997 PST
    | Mon Feb 10 09:32:01 1997 PST
    | Mon Feb 10 09:32:01 1997 PST
    | Mon Feb 10 14:32:01 1997 PST
    | Thu Jul 10 14:32:01 1997 PDT
    | Tue Jun 10 18:32:01 1997 PDT
    | Mon Feb 10 17:32:01 1997 PST
    | Tue Feb 11 17:32:01 1997 PST
    | Wed Feb 12 17:32:01 1997 PST
    | Thu Feb 13 17:32:01 1997 PST
    | Fri Feb 14 17:32:01 1997 PST
    | Sat Feb 15 17:32:01 1997 PST
    | Sun Feb 16 17:32:01 1997 PST
    | Tue Feb 16 17:32:01 0097 PST BC
    | Sat Feb 16 17:32:01 0097 PST
    | Thu Feb 16 17:32:01 0597 PST
    | Tue Feb 16 17:32:01 1097 PST
    | Sat Feb 16 17:32:01 1697 PST
    | Thu Feb 16 17:32:01 1797 PST
    | Tue Feb 16 17:32:01 1897 PST
    | Sun Feb 16 17:32:01 1997 PST
    | Sat Feb 16 17:32:01 2097 PST
    | Wed Feb 28 17:32:01 1996 PST
    | Thu Feb 29 17:32:01 1996 PST
    | Fri Mar 01 17:32:01 1996 PST
    | Mon Dec 30 17:32:01 1996 PST
    | Tue Dec 31 17:32:01 1996 PST
    | Wed Jan 01 17:32:01 1997 PST
    | Fri Feb 28 17:32:01 1997 PST
    | Sat Mar 01 17:32:01 1997 PST
    | Tue Dec 30 17:32:01 1997 PST
    | Wed Dec 31 17:32:01 1997 PST
    | Fri Dec 31 17:32:01 1999 PST
    | Sat Jan 01 17:32:01 2000 PST
    | Sun Dec 31 17:32:01 2000 PST
    | Mon Jan 01 17:32:01 2001 PST
(66 rows)

-- Demonstrate functions and operators
SELECT '' AS "48", d1 FROM TIMESTAMPTZ_TBL
   WHERE d1 > timestamp with time zone '1997-01-02';
 48 |               d1               
----+--------------------------------
    | infinity
    | Mon Feb 10 17:32:01 1997 PST
    | Mon Feb 10 17:32:01 1997 PST
    | Mon Feb 10 17:32:02 1997 PST
    | Mon Feb 10 17:32:01.4 1997 PST
    | Mon Feb 10 17:32:01.5 1997 PST
    | Mon Feb 10 17:32:01.6 1997 PST
    | Thu Jan 02 03:04:05 1997 PST
    | Mon Feb 10 17:32:01 1997 PST
    | Mon Feb 10 17:32:01 1997 PST
    | Mon Feb 10 17:32:01 1997 PST
    | Mon Feb 10 17:32:01 1997 PST
    | Tue Jun 10 17:32:01 1997 PDT
    | Sat Sep 22 18:19:20 2001 PDT
    | Wed Mar 15 08:14:01 2000 PST
    | Wed Mar 15 04:14:02 2000 PST
    | Wed Mar 15 02:14:03 2000 PST
    | Wed Mar 15 03:14:04 2000 PST
    | Wed Mar 15 01:14:05 2000 PST
    | Mon Feb 10 17:32:01 1997 PST
    | Mon Feb 10 17:32:01 1997 PST
    | Mon Feb 10 17:32:00 1997 PST
    | Mon Feb 10 17:32:01 1997 PST
    | Mon Feb 10 17:32:01 1997 PST
    | Mon Feb 10 17:32:01 1997 PST
    | Mon Feb 10 17:32:01 1997 PST
    | Mon Feb 10 17:32:01 1997 PST
    | Mon Feb 10 09:32:01 1997 PST
    | Mon Feb 10 09:32:01 1997 PST
    | Mon Feb 10 09:32:01 1997 PST
    | Mon Feb 10 14:32:01 1997 PST
    | Thu Jul 10 14:32:01 1997 PDT
    | Tue Jun 10 18:32:01 1997 PDT
    | Mon Feb 10 17:32:01 1997 PST
    | Tue Feb 11 17:32:01 1997 PST
    | Wed Feb 12 17:32:01 1997 PST
    | Thu Feb 13 17:32:01 1997 PST
    | Fri Feb 14 17:32:01 1997 PST
    | Sat Feb 15 17:32:01 1997 PST
    | Sun Feb 16 17:32:01 1997 PST
    | Sun Feb 16 17:32:01 1997 PST
    | Sat Feb 16 17:32:01 2097 PST
    | Fri Feb 28 17:32:01 1997 PST
    | Sat Mar 01 17:32:01 1997 PST
    | Tue Dec 30 17:32:01 1997 PST
    | Wed Dec 31 17:32:01 1997 PST
    | Fri Dec 31 17:32:01 1999 PST
    | Sat Jan 01 17:32:01 2000 PST
    | Sun Dec 31 17:32:01 2000 PST
    | Mon Jan 01 17:32:01 2001 PST
(50 rows)

SELECT '' AS "15", d1 FROM TIMESTAMPTZ_TBL
   WHERE d1 < timestamp with time zone '1997-01-02';
 15 |               d1                
----+---------------------------------
    | -infinity
    | Wed Dec 31 16:00:00 1969 PST
    | Tue Feb 16 17:32:01 0097 PST BC
    | Sat Feb 16 17:32:01 0097 PST
    | Thu Feb 16 17:32:01 0597 PST
    | Tue Feb 16 17:32:01 1097 PST
    | Sat Feb 16 17:32:01 1697 PST
    | Thu Feb 16 17:32:01 1797 PST
    | Tue Feb 16 17:32:01 1897 PST
    | Wed Feb 28 17:32:01 1996 PST
    | Thu Feb 29 17:32:01 1996 PST
    | Fri Mar 01 17:32:01 1996 PST
    | Mon Dec 30 17:32:01 1996 PST
    | Tue Dec 31 17:32:01 1996 PST
    | Wed Jan 01 17:32:01 1997 PST
(15 rows)

SELECT '' AS one, d1 FROM TIMESTAMPTZ_TBL
   WHERE d1 = timestamp with time zone '1997-01-02';
 one |              d1              
-----+------------------------------
     | Thu Jan 02 00:00:00 1997 PST
(1 row)

SELECT '' AS "63", d1 FROM TIMESTAMPTZ_TBL
   WHERE d1 != timestamp with time zone '1997-01-02';
 63 |               d1                
----+---------------------------------
    | -infinity
    | infinity
    | Wed Dec 31 16:00:00 1969 PST
    | Mon Feb 10 17:32:01 1997 PST
    | Mon Feb 10 17:32:01 1997 PST
    | Mon Feb 10 17:32:02 1997 PST
    | Mon Feb 10 17:32:01.4 1997 PST
    | Mon Feb 10 17:32:01.5 1997 PST
    | Mon Feb 10 17:32:01.6 1997 PST
    | Thu Jan 02 03:04:05 1997 PST
    | Mon Feb 10 17:32:01 1997 PST
    | Mon Feb 10 17:32:01 1997 PST
    | Mon Feb 10 17:32:01 1997 PST
    | Mon Feb 10 17:32:01 1997 PST
    | Tue Jun 10 17:32:01 1997 PDT
    | Sat Sep 22 18:19:20 2001 PDT
    | Wed Mar 15 08:14:01 2000 PST
    | Wed Mar 15 04:14:02 2000 PST
    | Wed Mar 15 02:14:03 2000 PST
    | Wed Mar 15 03:14:04 2000 PST
    | Wed Mar 15 01:14:05 2000 PST
    | Mon Feb 10 17:32:01 1997 PST
    | Mon Feb 10 17:32:01 1997 PST
    | Mon Feb 10 17:32:00 1997 PST
    | Mon Feb 10 17:32:01 1997 PST
    | Mon Feb 10 17:32:01 1997 PST
    | Mon Feb 10 17:32:01 1997 PST
    | Mon Feb 10 17:32:01 1997 PST
    | Mon Feb 10 17:32:01 1997 PST
    | Mon Feb 10 09:32:01 1997 PST
    | Mon Feb 10 09:32:01 1997 PST
    | Mon Feb 10 09:32:01 1997 PST
    | Mon Feb 10 14:32:01 1997 PST
    | Thu Jul 10 14:32:01 1997 PDT
    | Tue Jun 10 18:32:01 1997 PDT
    | Mon Feb 10 17:32:01 1997 PST
    | Tue Feb 11 17:32:01 1997 PST
    | Wed Feb 12 17:32:01 1997 PST
    | Thu Feb 13 17:32:01 1997 PST
    | Fri Feb 14 17:32:01 1997 PST
    | Sat Feb 15 17:32:01 1997 PST
    | Sun Feb 16 17:32:01 1997 PST
    | Tue Feb 16 17:32:01 0097 PST BC
    | Sat Feb 16 17:32:01 0097 PST
    | Thu Feb 16 17:32:01 0597 PST
    | Tue Feb 16 17:32:01 1097 PST
    | Sat Feb 16 17:32:01 1697 PST
    | Thu Feb 16 17:32:01 1797 PST
    | Tue Feb 16 17:32:01 1897 PST
    | Sun Feb 16 17:32:01 1997 PST
    | Sat Feb 16 17:32:01 2097 PST
    | Wed Feb 28 17:32:01 1996 PST
    | Thu Feb 29 17:32:01 1996 PST
    | Fri Mar 01 17:32:01 1996 PST
    | Mon Dec 30 17:32:01 1996 PST
    | Tue Dec 31 17:32:01 1996 PST
    | Wed Jan 01 17:32:01 1997 PST
    | Fri Feb 28 17:32:01 1997 PST
    | Sat Mar 01 17:32:01 1997 PST
    | Tue Dec 30 17:32:01 1997 PST
    | Wed Dec 31 17:32:01 1997 PST
    | Fri Dec 31 17:32:01 1999 PST
    | Sat Jan 01 17:32:01 2000 PST
    | Sun Dec 31 17:32:01 2000 PST
    | Mon Jan 01 17:32:01 2001 PST
(65 rows)

SELECT '' AS "16", d1 FROM TIMESTAMPTZ_TBL
   WHERE d1 <= timestamp with time zone '1997-01-02';
 16 |               d1                
----+---------------------------------
    | -infinity
    | Wed Dec 31 16:00:00 1969 PST
    | Thu Jan 02 00:00:00 1997 PST
    | Tue Feb 16 17:32:01 0097 PST BC
    | Sat Feb 16 17:32:01 0097 PST
    | Thu Feb 16 17:32:01 0597 PST
    | Tue Feb 16 17:32:01 1097 PST
    | Sat Feb 16 17:32:01 1697 PST
    | Thu Feb 16 17:32:01 1797 PST
    | Tue Feb 16 17:32:01 1897 PST
    | Wed Feb 28 17:32:01 1996 PST
    | Thu Feb 29 17:32:01 1996 PST
    | Fri Mar 01 17:32:01 1996 PST
    | Mon Dec 30 17:32:01 1996 PST
    | Tue Dec 31 17:32:01 1996 PST
    | Wed Jan 01 17:32:01 1997 PST
(16 rows)

SELECT '' AS "49", d1 FROM TIMESTAMPTZ_TBL
   WHERE d1 >= timestamp with time zone '1997-01-02';
 49 |               d1               
----+--------------------------------
    | infinity
    | Mon Feb 10 17:32:01 1997 PST
    | Mon Feb 10 17:32:01 1997 PST
    | Mon Feb 10 17:32:02 1997 PST
    | Mon Feb 10 17:32:01.4 1997 PST
    | Mon Feb 10 17:32:01.5 1997 PST
    | Mon Feb 10 17:32:01.6 1997 PST
    | Thu Jan 02 00:00:00 1997 PST
    | Thu Jan 02 03:04:05 1997 PST
    | Mon Feb 10 17:32:01 1997 PST
    | Mon Feb 10 17:32:01 1997 PST
    | Mon Feb 10 17:32:01 1997 PST
    | Mon Feb 10 17:32:01 1997 PST
    | Tue Jun 10 17:32:01 1997 PDT
    | Sat Sep 22 18:19:20 2001 PDT
    | Wed Mar 15 08:14:01 2000 PST
    | Wed Mar 15 04:14:02 2000 PST
    | Wed Mar 15 02:14:03 2000 PST
    | Wed Mar 15 03:14:04 2000 PST
    | Wed Mar 15 01:14:05 2000 PST
    | Mon Feb 10 17:32:01 1997 PST
    | Mon Feb 10 17:32:01 1997 PST
    | Mon Feb 10 17:32:00 1997 PST
    | Mon Feb 10 17:32:01 1997 PST
    | Mon Feb 10 17:32:01 1997 PST
    | Mon Feb 10 17:32:01 1997 PST
    | Mon Feb 10 17:32:01 1997 PST
    | Mon Feb 10 17:32:01 1997 PST
    | Mon Feb 10 09:32:01 1997 PST
    | Mon Feb 10 09:32:01 1997 PST
    | Mon Feb 10 09:32:01 1997 PST
    | Mon Feb 10 14:32:01 1997 PST
    | Thu Jul 10 14:32:01 1997 PDT
    | Tue Jun 10 18:32:01 1997 PDT
    | Mon Feb 10 17:32:01 1997 PST
    | Tue Feb 11 17:32:01 1997 PST
    | Wed Feb 12 17:32:01 1997 PST
    | Thu Feb 13 17:32:01 1997 PST
    | Fri Feb 14 17:32:01 1997 PST
    | Sat Feb 15 17:32:01 1997 PST
    | Sun Feb 16 17:32:01 1997 PST
    | Sun Feb 16 17:32:01 1997 PST
    | Sat Feb 16 17:32:01 2097 PST
    | Fri Feb 28 17:32:01 1997 PST
    | Sat Mar 01 17:32:01 1997 PST
    | Tue Dec 30 17:32:01 1997 PST
    | Wed Dec 31 17:32:01 1997 PST
    | Fri Dec 31 17:32:01 1999 PST
    | Sat Jan 01 17:32:01 2000 PST
    | Sun Dec 31 17:32:01 2000 PST
    | Mon Jan 01 17:32:01 2001 PST
(51 rows)

SELECT '' AS "54", d1 - timestamp with time zone '1997-01-02' AS diff
   FROM TIMESTAMPTZ_TBL WHERE d1 BETWEEN '1902-01-01' AND '2038-01-01';
 54 |                  diff                  
----+----------------------------------------
    | @ 9863 days 8 hours ago
    | @ 39 days 17 hours 32 mins 1 sec
    | @ 39 days 17 hours 32 mins 1 sec
    | @ 39 days 17 hours 32 mins 2 secs
    | @ 39 days 17 hours 32 mins 1.4 secs
    | @ 39 days 17 hours 32 mins 1.5 secs
    | @ 39 days 17 hours 32 mins 1.6 secs
    | @ 0
    | @ 3 hours 4 mins 5 secs
    | @ 39 days 17 hours 32 mins 1 sec
    | @ 39 days 17 hours 32 mins 1 sec
    | @ 39 days 17 hours 32 mins 1 sec
    | @ 39 days 17 hours 32 mins 1 sec
    | @ 159 days 16 hours 32 mins 1 sec
    | @ 1724 days 17 hours 19 mins 20 secs
    | @ 1168 days 8 hours 14 mins 1 sec
    | @ 1168 days 4 hours 14 mins 2 secs
    | @ 1168 days 2 hours 14 mins 3 secs
    | @ 1168 days 3 hours 14 mins 4 secs
    | @ 1168 days 1 hour 14 mins 5 secs
    | @ 39 days 17 hours 32 mins 1 sec
    | @ 39 days 17 hours 32 mins 1 sec
    | @ 39 days 17 hours 32 mins
    | @ 39 days 17 hours 32 mins 1 sec
    | @ 39 days 17 hours 32 mins 1 sec
    | @ 39 days 17 hours 32 mins 1 sec
    | @ 39 days 17 hours 32 mins 1 sec
    | @ 39 days 17 hours 32 mins 1 sec
    | @ 39 days 9 hours 32 mins 1 sec
    | @ 39 days 9 hours 32 mins 1 sec
    | @ 39 days 9 hours 32 mins 1 sec
    | @ 39 days 14 hours 32 mins 1 sec
    | @ 189 days 13 hours 32 mins 1 sec
    | @ 159 days 17 hours 32 mins 1 sec
    | @ 39 days 17 hours 32 mins 1 sec
    | @ 40 days 17 hours 32 mins 1 sec
    | @ 41 days 17 hours 32 mins 1 sec
    | @ 42 days 17 hours 32 mins 1 sec
    | @ 43 days 17 hours 32 mins 1 sec
    | @ 44 days 17 hours 32 mins 1 sec
    | @ 45 days 17 hours 32 mins 1 sec
    | @ 45 days 17 hours 32 mins 1 sec
    | @ 308 days 6 hours 27 mins 59 secs ago
    | @ 307 days 6 hours 27 mins 59 secs ago
    | @ 306 days 6 hours 27 mins 59 secs ago
    | @ 2 days 6 hours 27 mins 59 secs ago
    | @ 1 day 6 hours 27 mins 59 secs ago
    | @ 6 hours 27 mins 59 secs ago
    | @ 57 days 17 hours 32 mins 1 sec
    | @ 58 days 17 hours 32 mins 1 sec
    | @ 362 days 17 hours 32 mins 1 sec
    | @ 363 days 17 hours 32 mins 1 sec
    | @ 1093 days 17 hours 32 mins 1 sec
    | @ 1094 days 17 hours 32 mins 1 sec
    | @ 1459 days 17 hours 32 mins 1 sec
    | @ 1460 days 17 hours 32 mins 1 sec
(56 rows)

SELECT '' AS date_trunc_week, date_trunc( 'week', timestamp with time zone '2004-02-29 15:44:17.71393' ) AS week_trunc;
 date_trunc_week |          week_trunc          
-----------------+------------------------------
                 | Mon Feb 23 00:00:00 2004 PST
(1 row)

-- Test casting within a BETWEEN qualifier
SELECT '' AS "54", d1 - timestamp with time zone '1997-01-02' AS diff
  FROM TIMESTAMPTZ_TBL
  WHERE d1 BETWEEN timestamp with time zone '1902-01-01' AND timestamp with time zone '2038-01-01';
 54 |                  diff                  
----+----------------------------------------
    | @ 9863 days 8 hours ago
    | @ 39 days 17 hours 32 mins 1 sec
    | @ 39 days 17 hours 32 mins 1 sec
    | @ 39 days 17 hours 32 mins 2 secs
    | @ 39 days 17 hours 32 mins 1.4 secs
    | @ 39 days 17 hours 32 mins 1.5 secs
    | @ 39 days 17 hours 32 mins 1.6 secs
    | @ 0
    | @ 3 hours 4 mins 5 secs
    | @ 39 days 17 hours 32 mins 1 sec
    | @ 39 days 17 hours 32 mins 1 sec
    | @ 39 days 17 hours 32 mins 1 sec
    | @ 39 days 17 hours 32 mins 1 sec
    | @ 159 days 16 hours 32 mins 1 sec
    | @ 1724 days 17 hours 19 mins 20 secs
    | @ 1168 days 8 hours 14 mins 1 sec
    | @ 1168 days 4 hours 14 mins 2 secs
    | @ 1168 days 2 hours 14 mins 3 secs
    | @ 1168 days 3 hours 14 mins 4 secs
    | @ 1168 days 1 hour 14 mins 5 secs
    | @ 39 days 17 hours 32 mins 1 sec
    | @ 39 days 17 hours 32 mins 1 sec
    | @ 39 days 17 hours 32 mins
    | @ 39 days 17 hours 32 mins 1 sec
    | @ 39 days 17 hours 32 mins 1 sec
    | @ 39 days 17 hours 32 mins 1 sec
    | @ 39 days 17 hours 32 mins 1 sec
    | @ 39 days 17 hours 32 mins 1 sec
    | @ 39 days 9 hours 32 mins 1 sec
    | @ 39 days 9 hours 32 mins 1 sec
    | @ 39 days 9 hours 32 mins 1 sec
    | @ 39 days 14 hours 32 mins 1 sec
    | @ 189 days 13 hours 32 mins 1 sec
    | @ 159 days 17 hours 32 mins 1 sec
    | @ 39 days 17 hours 32 mins 1 sec
    | @ 40 days 17 hours 32 mins 1 sec
    | @ 41 days 17 hours 32 mins 1 sec
    | @ 42 days 17 hours 32 mins 1 sec
    | @ 43 days 17 hours 32 mins 1 sec
    | @ 44 days 17 hours 32 mins 1 sec
    | @ 45 days 17 hours 32 mins 1 sec
    | @ 45 days 17 hours 32 mins 1 sec
    | @ 308 days 6 hours 27 mins 59 secs ago
    | @ 307 days 6 hours 27 mins 59 secs ago
    | @ 306 days 6 hours 27 mins 59 secs ago
    | @ 2 days 6 hours 27 mins 59 secs ago
    | @ 1 day 6 hours 27 mins 59 secs ago
    | @ 6 hours 27 mins 59 secs ago
    | @ 57 days 17 hours 32 mins 1 sec
    | @ 58 days 17 hours 32 mins 1 sec
    | @ 362 days 17 hours 32 mins 1 sec
    | @ 363 days 17 hours 32 mins 1 sec
    | @ 1093 days 17 hours 32 mins 1 sec
    | @ 1094 days 17 hours 32 mins 1 sec
    | @ 1459 days 17 hours 32 mins 1 sec
    | @ 1460 days 17 hours 32 mins 1 sec
(56 rows)

SELECT '' AS "54", d1 as timestamptz,
   date_part( 'year', d1) AS year, date_part( 'month', d1) AS month,
   date_part( 'day', d1) AS day, date_part( 'hour', d1) AS hour,
   date_part( 'minute', d1) AS minute, date_part( 'second', d1) AS second
   FROM TIMESTAMPTZ_TBL WHERE d1 BETWEEN '1902-01-01' AND '2038-01-01';
 54 |          timestamptz           | year | month | day | hour | minute | second 
----+--------------------------------+------+-------+-----+------+--------+--------
    | Wed Dec 31 16:00:00 1969 PST   | 1969 |    12 |  31 |   16 |      0 |      0
    | Mon Feb 10 17:32:01 1997 PST   | 1997 |     2 |  10 |   17 |     32 |      1
    | Mon Feb 10 17:32:01 1997 PST   | 1997 |     2 |  10 |   17 |     32 |      1
    | Mon Feb 10 17:32:02 1997 PST   | 1997 |     2 |  10 |   17 |     32 |      2
    | Mon Feb 10 17:32:01.4 1997 PST | 1997 |     2 |  10 |   17 |     32 |    1.4
    | Mon Feb 10 17:32:01.5 1997 PST | 1997 |     2 |  10 |   17 |     32 |    1.5
    | Mon Feb 10 17:32:01.6 1997 PST | 1997 |     2 |  10 |   17 |     32 |    1.6
    | Thu Jan 02 00:00:00 1997 PST   | 1997 |     1 |   2 |    0 |      0 |      0
    | Thu Jan 02 03:04:05 1997 PST   | 1997 |     1 |   2 |    3 |      4 |      5
    | Mon Feb 10 17:32:01 1997 PST   | 1997 |     2 |  10 |   17 |     32 |      1
    | Mon Feb 10 17:32:01 1997 PST   | 1997 |     2 |  10 |   17 |     32 |      1
    | Mon Feb 10 17:32:01 1997 PST   | 1997 |     2 |  10 |   17 |     32 |      1
    | Mon Feb 10 17:32:01 1997 PST   | 1997 |     2 |  10 |   17 |     32 |      1
    | Tue Jun 10 17:32:01 1997 PDT   | 1997 |     6 |  10 |   17 |     32 |      1
    | Sat Sep 22 18:19:20 2001 PDT   | 2001 |     9 |  22 |   18 |     19 |     20
    | Wed Mar 15 08:14:01 2000 PST   | 2000 |     3 |  15 |    8 |     14 |      1
    | Wed Mar 15 04:14:02 2000 PST   | 2000 |     3 |  15 |    4 |     14 |      2
    | Wed Mar 15 02:14:03 2000 PST   | 2000 |     3 |  15 |    2 |     14 |      3
    | Wed Mar 15 03:14:04 2000 PST   | 2000 |     3 |  15 |    3 |     14 |      4
    | Wed Mar 15 01:14:05 2000 PST   | 2000 |     3 |  15 |    1 |     14 |      5
    | Mon Feb 10 17:32:01 1997 PST   | 1997 |     2 |  10 |   17 |     32 |      1
    | Mon Feb 10 17:32:01 1997 PST   | 1997 |     2 |  10 |   17 |     32 |      1
    | Mon Feb 10 17:32:00 1997 PST   | 1997 |     2 |  10 |   17 |     32 |      0
    | Mon Feb 10 17:32:01 1997 PST   | 1997 |     2 |  10 |   17 |     32 |      1
    | Mon Feb 10 17:32:01 1997 PST   | 1997 |     2 |  10 |   17 |     32 |      1
    | Mon Feb 10 17:32:01 1997 PST   | 1997 |     2 |  10 |   17 |     32 |      1
    | Mon Feb 10 17:32:01 1997 PST   | 1997 |     2 |  10 |   17 |     32 |      1
    | Mon Feb 10 17:32:01 1997 PST   | 1997 |     2 |  10 |   17 |     32 |      1
    | Mon Feb 10 09:32:01 1997 PST   | 1997 |     2 |  10 |    9 |     32 |      1
    | Mon Feb 10 09:32:01 1997 PST   | 1997 |     2 |  10 |    9 |     32 |      1
    | Mon Feb 10 09:32:01 1997 PST   | 1997 |     2 |  10 |    9 |     32 |      1
    | Mon Feb 10 14:32:01 1997 PST   | 1997 |     2 |  10 |   14 |     32 |      1
    | Thu Jul 10 14:32:01 1997 PDT   | 1997 |     7 |  10 |   14 |     32 |      1
    | Tue Jun 10 18:32:01 1997 PDT   | 1997 |     6 |  10 |   18 |     32 |      1
    | Mon Feb 10 17:32:01 1997 PST   | 1997 |     2 |  10 |   17 |     32 |      1
    | Tue Feb 11 17:32:01 1997 PST   | 1997 |     2 |  11 |   17 |     32 |      1
    | Wed Feb 12 17:32:01 1997 PST   | 1997 |     2 |  12 |   17 |     32 |      1
    | Thu Feb 13 17:32:01 1997 PST   | 1997 |     2 |  13 |   17 |     32 |      1
    | Fri Feb 14 17:32:01 1997 PST   | 1997 |     2 |  14 |   17 |     32 |      1
    | Sat Feb 15 17:32:01 1997 PST   | 1997 |     2 |  15 |   17 |     32 |      1
    | Sun Feb 16 17:32:01 1997 PST   | 1997 |     2 |  16 |   17 |     32 |      1
    | Sun Feb 16 17:32:01 1997 PST   | 1997 |     2 |  16 |   17 |     32 |      1
    | Wed Feb 28 17:32:01 1996 PST   | 1996 |     2 |  28 |   17 |     32 |      1
    | Thu Feb 29 17:32:01 1996 PST   | 1996 |     2 |  29 |   17 |     32 |      1
    | Fri Mar 01 17:32:01 1996 PST   | 1996 |     3 |   1 |   17 |     32 |      1
    | Mon Dec 30 17:32:01 1996 PST   | 1996 |    12 |  30 |   17 |     32 |      1
    | Tue Dec 31 17:32:01 1996 PST   | 1996 |    12 |  31 |   17 |     32 |      1
    | Wed Jan 01 17:32:01 1997 PST   | 1997 |     1 |   1 |   17 |     32 |      1
    | Fri Feb 28 17:32:01 1997 PST   | 1997 |     2 |  28 |   17 |     32 |      1
    | Sat Mar 01 17:32:01 1997 PST   | 1997 |     3 |   1 |   17 |     32 |      1
    | Tue Dec 30 17:32:01 1997 PST   | 1997 |    12 |  30 |   17 |     32 |      1
    | Wed Dec 31 17:32:01 1997 PST   | 1997 |    12 |  31 |   17 |     32 |      1
    | Fri Dec 31 17:32:01 1999 PST   | 1999 |    12 |  31 |   17 |     32 |      1
    | Sat Jan 01 17:32:01 2000 PST   | 2000 |     1 |   1 |   17 |     32 |      1
    | Sun Dec 31 17:32:01 2000 PST   | 2000 |    12 |  31 |   17 |     32 |      1
    | Mon Jan 01 17:32:01 2001 PST   | 2001 |     1 |   1 |   17 |     32 |      1
(56 rows)

SELECT '' AS "54", d1 as timestamptz,
   date_part( 'quarter', d1) AS quarter, date_part( 'msec', d1) AS msec,
   date_part( 'usec', d1) AS usec
   FROM TIMESTAMPTZ_TBL WHERE d1 BETWEEN '1902-01-01' AND '2038-01-01';
 54 |          timestamptz           | quarter | msec  |   usec   
----+--------------------------------+---------+-------+----------
    | Wed Dec 31 16:00:00 1969 PST   |       4 |     0 |        0
    | Mon Feb 10 17:32:01 1997 PST   |       1 |  1000 |  1000000
    | Mon Feb 10 17:32:01 1997 PST   |       1 |  1000 |  1000000
    | Mon Feb 10 17:32:02 1997 PST   |       1 |  2000 |  2000000
    | Mon Feb 10 17:32:01.4 1997 PST |       1 |  1400 |  1400000
    | Mon Feb 10 17:32:01.5 1997 PST |       1 |  1500 |  1500000
    | Mon Feb 10 17:32:01.6 1997 PST |       1 |  1600 |  1600000
    | Thu Jan 02 00:00:00 1997 PST   |       1 |     0 |        0
    | Thu Jan 02 03:04:05 1997 PST   |       1 |  5000 |  5000000
    | Mon Feb 10 17:32:01 1997 PST   |       1 |  1000 |  1000000
    | Mon Feb 10 17:32:01 1997 PST   |       1 |  1000 |  1000000
    | Mon Feb 10 17:32:01 1997 PST   |       1 |  1000 |  1000000
    | Mon Feb 10 17:32:01 1997 PST   |       1 |  1000 |  1000000
    | Tue Jun 10 17:32:01 1997 PDT   |       2 |  1000 |  1000000
    | Sat Sep 22 18:19:20 2001 PDT   |       3 | 20000 | 20000000
    | Wed Mar 15 08:14:01 2000 PST   |       1 |  1000 |  1000000
    | Wed Mar 15 04:14:02 2000 PST   |       1 |  2000 |  2000000
    | Wed Mar 15 02:14:03 2000 PST   |       1 |  3000 |  3000000
    | Wed Mar 15 03:14:04 2000 PST   |       1 |  4000 |  4000000
    | Wed Mar 15 01:14:05 2000 PST   |       1 |  5000 |  5000000
    | Mon Feb 10 17:32:01 1997 PST   |       1 |  1000 |  1000000
    | Mon Feb 10 17:32:01 1997 PST   |       1 |  1000 |  1000000
    | Mon Feb 10 17:32:00 1997 PST   |       1 |     0 |        0
    | Mon Feb 10 17:32:01 1997 PST   |       1 |  1000 |  1000000
    | Mon Feb 10 17:32:01 1997 PST   |       1 |  1000 |  1000000
    | Mon Feb 10 17:32:01 1997 PST   |       1 |  1000 |  1000000
    | Mon Feb 10 17:32:01 1997 PST   |       1 |  1000 |  1000000
    | Mon Feb 10 17:32:01 1997 PST   |       1 |  1000 |  1000000
    | Mon Feb 10 09:32:01 1997 PST   |       1 |  1000 |  1000000
    | Mon Feb 10 09:32:01 1997 PST   |       1 |  1000 |  1000000
    | Mon Feb 10 09:32:01 1997 PST   |       1 |  1000 |  1000000
    | Mon Feb 10 14:32:01 1997 PST   |       1 |  1000 |  1000000
    | Thu Jul 10 14:32:01 1997 PDT   |       3 |  1000 |  1000000
    | Tue Jun 10 18:32:01 1997 PDT   |       2 |  1000 |  1000000
    | Mon Feb 10 17:32:01 1997 PST   |       1 |  1000 |  1000000
    | Tue Feb 11 17:32:01 1997 PST   |       1 |  1000 |  1000000
    | Wed Feb 12 17:32:01 1997 PST   |       1 |  1000 |  1000000
    | Thu Feb 13 17:32:01 1997 PST   |       1 |  1000 |  1000000
    | Fri Feb 14 17:32:01 1997 PST   |       1 |  1000 |  1000000
    | Sat Feb 15 17:32:01 1997 PST   |       1 |  1000 |  1000000
    | Sun Feb 16 17:32:01 1997 PST   |       1 |  1000 |  1000000
    | Sun Feb 16 17:32:01 1997 PST   |       1 |  1000 |  1000000
    | Wed Feb 28 17:32:01 1996 PST   |       1 |  1000 |  1000000
    | Thu Feb 29 17:32:01 1996 PST   |       1 |  1000 |  1000000
    | Fri Mar 01 17:32:01 1996 PST   |       1 |  1000 |  1000000
    | Mon Dec 30 17:32:01 1996 PST   |       4 |  1000 |  1000000
    | Tue Dec 31 17:32:01 1996 PST   |       4 |  1000 |  1000000
    | Wed Jan 01 17:32:01 1997 PST   |       1 |  1000 |  1000000
    | Fri Feb 28 17:32:01 1997 PST   |       1 |  1000 |  1000000
    | Sat Mar 01 17:32:01 1997 PST   |       1 |  1000 |  1000000
    | Tue Dec 30 17:32:01 1997 PST   |       4 |  1000 |  1000000
    | Wed Dec 31 17:32:01 1997 PST   |       4 |  1000 |  1000000
    | Fri Dec 31 17:32:01 1999 PST   |       4 |  1000 |  1000000
    | Sat Jan 01 17:32:01 2000 PST   |       1 |  1000 |  1000000
    | Sun Dec 31 17:32:01 2000 PST   |       4 |  1000 |  1000000
    | Mon Jan 01 17:32:01 2001 PST   |       1 |  1000 |  1000000
(56 rows)

SELECT '' AS "54", d1 as timestamptz,
   date_part( 'isoyear', d1) AS isoyear, date_part( 'week', d1) AS week,
   date_part( 'dow', d1) AS dow
   FROM TIMESTAMPTZ_TBL WHERE d1 BETWEEN '1902-01-01' AND '2038-01-01';
 54 |          timestamptz           | isoyear | week | dow 
----+--------------------------------+---------+------+-----
    | Wed Dec 31 16:00:00 1969 PST   |    1970 |    1 |   3
    | Mon Feb 10 17:32:01 1997 PST   |    1997 |    7 |   1
    | Mon Feb 10 17:32:01 1997 PST   |    1997 |    7 |   1
    | Mon Feb 10 17:32:02 1997 PST   |    1997 |    7 |   1
    | Mon Feb 10 17:32:01.4 1997 PST |    1997 |    7 |   1
    | Mon Feb 10 17:32:01.5 1997 PST |    1997 |    7 |   1
    | Mon Feb 10 17:32:01.6 1997 PST |    1997 |    7 |   1
    | Thu Jan 02 00:00:00 1997 PST   |    1997 |    1 |   4
    | Thu Jan 02 03:04:05 1997 PST   |    1997 |    1 |   4
    | Mon Feb 10 17:32:01 1997 PST   |    1997 |    7 |   1
    | Mon Feb 10 17:32:01 1997 PST   |    1997 |    7 |   1
    | Mon Feb 10 17:32:01 1997 PST   |    1997 |    7 |   1
    | Mon Feb 10 17:32:01 1997 PST   |    1997 |    7 |   1
    | Tue Jun 10 17:32:01 1997 PDT   |    1997 |   24 |   2
    | Sat Sep 22 18:19:20 2001 PDT   |    2001 |   38 |   6
    | Wed Mar 15 08:14:01 2000 PST   |    2000 |   11 |   3
    | Wed Mar 15 04:14:02 2000 PST   |    2000 |   11 |   3
    | Wed Mar 15 02:14:03 2000 PST   |    2000 |   11 |   3
    | Wed Mar 15 03:14:04 2000 PST   |    2000 |   11 |   3
    | Wed Mar 15 01:14:05 2000 PST   |    2000 |   11 |   3
    | Mon Feb 10 17:32:01 1997 PST   |    1997 |    7 |   1
    | Mon Feb 10 17:32:01 1997 PST   |    1997 |    7 |   1
    | Mon Feb 10 17:32:00 1997 PST   |    1997 |    7 |   1
    | Mon Feb 10 17:32:01 1997 PST   |    1997 |    7 |   1
    | Mon Feb 10 17:32:01 1997 PST   |    1997 |    7 |   1
    | Mon Feb 10 17:32:01 1997 PST   |    1997 |    7 |   1
    | Mon Feb 10 17:32:01 1997 PST   |    1997 |    7 |   1
    | Mon Feb 10 17:32:01 1997 PST   |    1997 |    7 |   1
    | Mon Feb 10 09:32:01 1997 PST   |    1997 |    7 |   1
    | Mon Feb 10 09:32:01 1997 PST   |    1997 |    7 |   1
    | Mon Feb 10 09:32:01 1997 PST   |    1997 |    7 |   1
    | Mon Feb 10 14:32:01 1997 PST   |    1997 |    7 |   1
    | Thu Jul 10 14:32:01 1997 PDT   |    1997 |   28 |   4
    | Tue Jun 10 18:32:01 1997 PDT   |    1997 |   24 |   2
    | Mon Feb 10 17:32:01 1997 PST   |    1997 |    7 |   1
    | Tue Feb 11 17:32:01 1997 PST   |    1997 |    7 |   2
    | Wed Feb 12 17:32:01 1997 PST   |    1997 |    7 |   3
    | Thu Feb 13 17:32:01 1997 PST   |    1997 |    7 |   4
    | Fri Feb 14 17:32:01 1997 PST   |    1997 |    7 |   5
    | Sat Feb 15 17:32:01 1997 PST   |    1997 |    7 |   6
    | Sun Feb 16 17:32:01 1997 PST   |    1997 |    7 |   0
    | Sun Feb 16 17:32:01 1997 PST   |    1997 |    7 |   0
    | Wed Feb 28 17:32:01 1996 PST   |    1996 |    9 |   3
    | Thu Feb 29 17:32:01 1996 PST   |    1996 |    9 |   4
    | Fri Mar 01 17:32:01 1996 PST   |    1996 |    9 |   5
    | Mon Dec 30 17:32:01 1996 PST   |    1997 |    1 |   1
    | Tue Dec 31 17:32:01 1996 PST   |    1997 |    1 |   2
    | Wed Jan 01 17:32:01 1997 PST   |    1997 |    1 |   3
    | Fri Feb 28 17:32:01 1997 PST   |    1997 |    9 |   5
    | Sat Mar 01 17:32:01 1997 PST   |    1997 |    9 |   6
    | Tue Dec 30 17:32:01 1997 PST   |    1998 |    1 |   2
    | Wed Dec 31 17:32:01 1997 PST   |    1998 |    1 |   3
    | Fri Dec 31 17:32:01 1999 PST   |    1999 |   52 |   5
    | Sat Jan 01 17:32:01 2000 PST   |    1999 |   52 |   6
    | Sun Dec 31 17:32:01 2000 PST   |    2000 |   52 |   0
    | Mon Jan 01 17:32:01 2001 PST   |    2001 |    1 |   1
(56 rows)

-- TO_CHAR()
SELECT '' AS to_char_1, to_char(d1, 'DAY Day day DY Dy dy MONTH Month month RM MON Mon mon')
   FROM TIMESTAMPTZ_TBL;
 to_char_1 |                                         to_char                                          
-----------+------------------------------------------------------------------------------------------
           | 
           | 
           | WEDNESDAY Wednesday wednesday WED Wed wed DECEMBER  December  december  XII  DEC Dec dec
           | MONDAY    Monday    monday    MON Mon mon FEBRUARY  February  february  II   FEB Feb feb
           | MONDAY    Monday    monday    MON Mon mon FEBRUARY  February  february  II   FEB Feb feb
           | MONDAY    Monday    monday    MON Mon mon FEBRUARY  February  february  II   FEB Feb feb
           | MONDAY    Monday    monday    MON Mon mon FEBRUARY  February  february  II   FEB Feb feb
           | MONDAY    Monday    monday    MON Mon mon FEBRUARY  February  february  II   FEB Feb feb
           | MONDAY    Monday    monday    MON Mon mon FEBRUARY  February  february  II   FEB Feb feb
           | THURSDAY  Thursday  thursday  THU Thu thu JANUARY   January   january   I    JAN Jan jan
           | THURSDAY  Thursday  thursday  THU Thu thu JANUARY   January   january   I    JAN Jan jan
           | MONDAY    Monday    monday    MON Mon mon FEBRUARY  February  february  II   FEB Feb feb
           | MONDAY    Monday    monday    MON Mon mon FEBRUARY  February  february  II   FEB Feb feb
           | MONDAY    Monday    monday    MON Mon mon FEBRUARY  February  february  II   FEB Feb feb
           | MONDAY    Monday    monday    MON Mon mon FEBRUARY  February  february  II   FEB Feb feb
           | TUESDAY   Tuesday   tuesday   TUE Tue tue JUNE      June      june      VI   JUN Jun jun
           | SATURDAY  Saturday  saturday  SAT Sat sat SEPTEMBER September september IX   SEP Sep sep
           | WEDNESDAY Wednesday wednesday WED Wed wed MARCH     March     march     III  MAR Mar mar
           | WEDNESDAY Wednesday wednesday WED Wed wed MARCH     March     march     III  MAR Mar mar
           | WEDNESDAY Wednesday wednesday WED Wed wed MARCH     March     march     III  MAR Mar mar
           | WEDNESDAY Wednesday wednesday WED Wed wed MARCH     March     march     III  MAR Mar mar
           | WEDNESDAY Wednesday wednesday WED Wed wed MARCH     March     march     III  MAR Mar mar
           | MONDAY    Monday    monday    MON Mon mon FEBRUARY  February  february  II   FEB Feb feb
           | MONDAY    Monday    monday    MON Mon mon FEBRUARY  February  february  II   FEB Feb feb
           | MONDAY    Monday    monday    MON Mon mon FEBRUARY  February  february  II   FEB Feb feb
           | MONDAY    Monday    monday    MON Mon mon FEBRUARY  February  february  II   FEB Feb feb
           | MONDAY    Monday    monday    MON Mon mon FEBRUARY  February  february  II   FEB Feb feb
           | MONDAY    Monday    monday    MON Mon mon FEBRUARY  February  february  II   FEB Feb feb
           | MONDAY    Monday    monday    MON Mon mon FEBRUARY  February  february  II   FEB Feb feb
           | MONDAY    Monday    monday    MON Mon mon FEBRUARY  February  february  II   FEB Feb feb
           | MONDAY    Monday    monday    MON Mon mon FEBRUARY  February  february  II   FEB Feb feb
           | MONDAY    Monday    monday    MON Mon mon FEBRUARY  February  february  II   FEB Feb feb
           | MONDAY    Monday    monday    MON Mon mon FEBRUARY  February  february  II   FEB Feb feb
           | MONDAY    Monday    monday    MON Mon mon FEBRUARY  February  february  II   FEB Feb feb
           | THURSDAY  Thursday  thursday  THU Thu thu JULY      July      july      VII  JUL Jul jul
           | TUESDAY   Tuesday   tuesday   TUE Tue tue JUNE      June      june      VI   JUN Jun jun
           | MONDAY    Monday    monday    MON Mon mon FEBRUARY  February  february  II   FEB Feb feb
           | TUESDAY   Tuesday   tuesday   TUE Tue tue FEBRUARY  February  february  II   FEB Feb feb
           | WEDNESDAY Wednesday wednesday WED Wed wed FEBRUARY  February  february  II   FEB Feb feb
           | THURSDAY  Thursday  thursday  THU Thu thu FEBRUARY  February  february  II   FEB Feb feb
           | FRIDAY    Friday    friday    FRI Fri fri FEBRUARY  February  february  II   FEB Feb feb
           | SATURDAY  Saturday  saturday  SAT Sat sat FEBRUARY  February  february  II   FEB Feb feb
           | SUNDAY    Sunday    sunday    SUN Sun sun FEBRUARY  February  february  II   FEB Feb feb
           | TUESDAY   Tuesday   tuesday   TUE Tue tue FEBRUARY  February  february  II   FEB Feb feb
           | SATURDAY  Saturday  saturday  SAT Sat sat FEBRUARY  February  february  II   FEB Feb feb
           | THURSDAY  Thursday  thursday  THU Thu thu FEBRUARY  February  february  II   FEB Feb feb
           | TUESDAY   Tuesday   tuesday   TUE Tue tue FEBRUARY  February  february  II   FEB Feb feb
           | SATURDAY  Saturday  saturday  SAT Sat sat FEBRUARY  February  february  II   FEB Feb feb
           | THURSDAY  Thursday  thursday  THU Thu thu FEBRUARY  February  february  II   FEB Feb feb
           | TUESDAY   Tuesday   tuesday   TUE Tue tue FEBRUARY  February  february  II   FEB Feb feb
           | SUNDAY    Sunday    sunday    SUN Sun sun FEBRUARY  February  february  II   FEB Feb feb
           | SATURDAY  Saturday  saturday  SAT Sat sat FEBRUARY  February  february  II   FEB Feb feb
           | WEDNESDAY Wednesday wednesday WED Wed wed FEBRUARY  February  february  II   FEB Feb feb
           | THURSDAY  Thursday  thursday  THU Thu thu FEBRUARY  February  february  II   FEB Feb feb
           | FRIDAY    Friday    friday    FRI Fri fri MARCH     March     march     III  MAR Mar mar
           | MONDAY    Monday    monday    MON Mon mon DECEMBER  December  december  XII  DEC Dec dec
           | TUESDAY   Tuesday   tuesday   TUE Tue tue DECEMBER  December  december  XII  DEC Dec dec
           | WEDNESDAY Wednesday wednesday WED Wed wed JANUARY   January   january   I    JAN Jan jan
           | FRIDAY    Friday    friday    FRI Fri fri FEBRUARY  February  february  II   FEB Feb feb
           | SATURDAY  Saturday  saturday  SAT Sat sat MARCH     March     march     III  MAR Mar mar
           | TUESDAY   Tuesday   tuesday   TUE Tue tue DECEMBER  December  december  XII  DEC Dec dec
           | WEDNESDAY Wednesday wednesday WED Wed wed DECEMBER  December  december  XII  DEC Dec dec
           | FRIDAY    Friday    friday    FRI Fri fri DECEMBER  December  december  XII  DEC Dec dec
           | SATURDAY  Saturday  saturday  SAT Sat sat JANUARY   January   january   I    JAN Jan jan
           | SUNDAY    Sunday    sunday    SUN Sun sun DECEMBER  December  december  XII  DEC Dec dec
           | MONDAY    Monday    monday    MON Mon mon JANUARY   January   january   I    JAN Jan jan
(66 rows)

SELECT '' AS to_char_2, to_char(d1, 'FMDAY FMDay FMday FMMONTH FMMonth FMmonth FMRM')
   FROM TIMESTAMPTZ_TBL;
 to_char_2 |                           to_char                            
-----------+--------------------------------------------------------------
           | 
           | 
           | WEDNESDAY Wednesday wednesday DECEMBER December december XII
           | MONDAY Monday monday FEBRUARY February february II
           | MONDAY Monday monday FEBRUARY February february II
           | MONDAY Monday monday FEBRUARY February february II
           | MONDAY Monday monday FEBRUARY February february II
           | MONDAY Monday monday FEBRUARY February february II
           | MONDAY Monday monday FEBRUARY February february II
           | THURSDAY Thursday thursday JANUARY January january I
           | THURSDAY Thursday thursday JANUARY January january I
           | MONDAY Monday monday FEBRUARY February february II
           | MONDAY Monday monday FEBRUARY February february II
           | MONDAY Monday monday FEBRUARY February february II
           | MONDAY Monday monday FEBRUARY February february II
           | TUESDAY Tuesday tuesday JUNE June june VI
           | SATURDAY Saturday saturday SEPTEMBER September september IX
           | WEDNESDAY Wednesday wednesday MARCH March march III
           | WEDNESDAY Wednesday wednesday MARCH March march III
           | WEDNESDAY Wednesday wednesday MARCH March march III
           | WEDNESDAY Wednesday wednesday MARCH March march III
           | WEDNESDAY Wednesday wednesday MARCH March march III
           | MONDAY Monday monday FEBRUARY February february II
           | MONDAY Monday monday FEBRUARY February february II
           | MONDAY Monday monday FEBRUARY February february II
           | MONDAY Monday monday FEBRUARY February february II
           | MONDAY Monday monday FEBRUARY February february II
           | MONDAY Monday monday FEBRUARY February february II
           | MONDAY Monday monday FEBRUARY February february II
           | MONDAY Monday monday FEBRUARY February february II
           | MONDAY Monday monday FEBRUARY February february II
           | MONDAY Monday monday FEBRUARY February february II
           | MONDAY Monday monday FEBRUARY February february II
           | MONDAY Monday monday FEBRUARY February february II
           | THURSDAY Thursday thursday JULY July july VII
           | TUESDAY Tuesday tuesday JUNE June june VI
           | MONDAY Monday monday FEBRUARY February february II
           | TUESDAY Tuesday tuesday FEBRUARY February february II
           | WEDNESDAY Wednesday wednesday FEBRUARY February february II
           | THURSDAY Thursday thursday FEBRUARY February february II
           | FRIDAY Friday friday FEBRUARY February february II
           | SATURDAY Saturday saturday FEBRUARY February february II
           | SUNDAY Sunday sunday FEBRUARY February february II
           | TUESDAY Tuesday tuesday FEBRUARY February february II
           | SATURDAY Saturday saturday FEBRUARY February february II
           | THURSDAY Thursday thursday FEBRUARY February february II
           | TUESDAY Tuesday tuesday FEBRUARY February february II
           | SATURDAY Saturday saturday FEBRUARY February february II
           | THURSDAY Thursday thursday FEBRUARY February february II
           | TUESDAY Tuesday tuesday FEBRUARY February february II
           | SUNDAY Sunday sunday FEBRUARY February february II
           | SATURDAY Saturday saturday FEBRUARY February february II
           | WEDNESDAY Wednesday wednesday FEBRUARY February february II
           | THURSDAY Thursday thursday FEBRUARY February february II
           | FRIDAY Friday friday MARCH March march III
           | MONDAY Monday monday DECEMBER December december XII
           | TUESDAY Tuesday tuesday DECEMBER December december XII
           | WEDNESDAY Wednesday wednesday JANUARY January january I
           | FRIDAY Friday friday FEBRUARY February february II
           | SATURDAY Saturday saturday MARCH March march III
           | TUESDAY Tuesday tuesday DECEMBER December december XII
           | WEDNESDAY Wednesday wednesday DECEMBER December december XII
           | FRIDAY Friday friday DECEMBER December december XII
           | SATURDAY Saturday saturday JANUARY January january I
           | SUNDAY Sunday sunday DECEMBER December december XII
           | MONDAY Monday monday JANUARY January january I
(66 rows)

SELECT '' AS to_char_3, to_char(d1, 'Y,YYY YYYY YYY YY Y CC Q MM WW DDD DD D J')
   FROM TIMESTAMPTZ_TBL;
 to_char_3 |                     to_char                     
-----------+-------------------------------------------------
           | 
           | 
           | 1,969 1969 969 69 9 20 4 12 53 365 31 4 2440587
           | 1,997 1997 997 97 7 20 1 02 06 041 10 2 2450490
           | 1,997 1997 997 97 7 20 1 02 06 041 10 2 2450490
           | 1,997 1997 997 97 7 20 1 02 06 041 10 2 2450490
           | 1,997 1997 997 97 7 20 1 02 06 041 10 2 2450490
           | 1,997 1997 997 97 7 20 1 02 06 041 10 2 2450490
           | 1,997 1997 997 97 7 20 1 02 06 041 10 2 2450490
           | 1,997 1997 997 97 7 20 1 01 01 002 02 5 2450451
           | 1,997 1997 997 97 7 20 1 01 01 002 02 5 2450451
           | 1,997 1997 997 97 7 20 1 02 06 041 10 2 2450490
           | 1,997 1997 997 97 7 20 1 02 06 041 10 2 2450490
           | 1,997 1997 997 97 7 20 1 02 06 041 10 2 2450490
           | 1,997 1997 997 97 7 20 1 02 06 041 10 2 2450490
           | 1,997 1997 997 97 7 20 2 06 23 161 10 3 2450610
           | 2,001 2001 001 01 1 21 3 09 38 265 22 7 2452175
           | 2,000 2000 000 00 0 20 1 03 11 075 15 4 2451619
           | 2,000 2000 000 00 0 20 1 03 11 075 15 4 2451619
           | 2,000 2000 000 00 0 20 1 03 11 075 15 4 2451619
           | 2,000 2000 000 00 0 20 1 03 11 075 15 4 2451619
           | 2,000 2000 000 00 0 20 1 03 11 075 15 4 2451619
           | 1,997 1997 997 97 7 20 1 02 06 041 10 2 2450490
           | 1,997 1997 997 97 7 20 1 02 06 041 10 2 2450490
           | 1,997 1997 997 97 7 20 1 02 06 041 10 2 2450490
           | 1,997 1997 997 97 7 20 1 02 06 041 10 2 2450490
           | 1,997 1997 997 97 7 20 1 02 06 041 10 2 2450490
           | 1,997 1997 997 97 7 20 1 02 06 041 10 2 2450490
           | 1,997 1997 997 97 7 20 1 02 06 041 10 2 2450490
           | 1,997 1997 997 97 7 20 1 02 06 041 10 2 2450490
           | 1,997 1997 997 97 7 20 1 02 06 041 10 2 2450490
           | 1,997 1997 997 97 7 20 1 02 06 041 10 2 2450490
           | 1,997 1997 997 97 7 20 1 02 06 041 10 2 2450490
           | 1,997 1997 997 97 7 20 1 02 06 041 10 2 2450490
           | 1,997 1997 997 97 7 20 3 07 28 191 10 5 2450640
           | 1,997 1997 997 97 7 20 2 06 23 161 10 3 2450610
           | 1,997 1997 997 97 7 20 1 02 06 041 10 2 2450490
           | 1,997 1997 997 97 7 20 1 02 06 042 11 3 2450491
           | 1,997 1997 997 97 7 20 1 02 07 043 12 4 2450492
           | 1,997 1997 997 97 7 20 1 02 07 044 13 5 2450493
           | 1,997 1997 997 97 7 20 1 02 07 045 14 6 2450494
           | 1,997 1997 997 97 7 20 1 02 07 046 15 7 2450495
           | 1,997 1997 997 97 7 20 1 02 07 047 16 1 2450496
           | 0,097 0097 097 97 7 -1 1 02 07 047 16 3 1686042
           | 0,097 0097 097 97 7 01 1 02 07 047 16 7 1756536
           | 0,597 0597 597 97 7 06 1 02 07 047 16 5 1939157
           | 1,097 1097 097 97 7 11 1 02 07 047 16 3 2121778
           | 1,697 1697 697 97 7 17 1 02 07 047 16 7 2340924
           | 1,797 1797 797 97 7 18 1 02 07 047 16 5 2377448
           | 1,897 1897 897 97 7 19 1 02 07 047 16 3 2413972
           | 1,997 1997 997 97 7 20 1 02 07 047 16 1 2450496
           | 2,097 2097 097 97 7 21 1 02 07 047 16 7 2487021
           | 1,996 1996 996 96 6 20 1 02 09 059 28 4 2450142
           | 1,996 1996 996 96 6 20 1 02 09 060 29 5 2450143
           | 1,996 1996 996 96 6 20 1 03 09 061 01 6 2450144
           | 1,996 1996 996 96 6 20 4 12 53 365 30 2 2450448
           | 1,996 1996 996 96 6 20 4 12 53 366 31 3 2450449
           | 1,997 1997 997 97 7 20 1 01 01 001 01 4 2450450
           | 1,997 1997 997 97 7 20 1 02 09 059 28 6 2450508
           | 1,997 1997 997 97 7 20 1 03 09 060 01 7 2450509
           | 1,997 1997 997 97 7 20 4 12 52 364 30 3 2450813
           | 1,997 1997 997 97 7 20 4 12 53 365 31 4 2450814
           | 1,999 1999 999 99 9 20 4 12 53 365 31 6 2451544
           | 2,000 2000 000 00 0 20 1 01 01 001 01 7 2451545
           | 2,000 2000 000 00 0 20 4 12 53 366 31 1 2451910
           | 2,001 2001 001 01 1 21 1 01 01 001 01 2 2451911
(66 rows)

SELECT '' AS to_char_4, to_char(d1, 'FMY,YYY FMYYYY FMYYY FMYY FMY FMCC FMQ FMMM FMWW FMDDD FMDD FMD FMJ')
   FROM TIMESTAMPTZ_TBL;
 to_char_4 |                     to_char                     
-----------+-------------------------------------------------
           | 
           | 
           | 1,969 1969 969 69 9 20 4 12 53 365 31 4 2440587
           | 1,997 1997 997 97 7 20 1 2 6 41 10 2 2450490
           | 1,997 1997 997 97 7 20 1 2 6 41 10 2 2450490
           | 1,997 1997 997 97 7 20 1 2 6 41 10 2 2450490
           | 1,997 1997 997 97 7 20 1 2 6 41 10 2 2450490
           | 1,997 1997 997 97 7 20 1 2 6 41 10 2 2450490
           | 1,997 1997 997 97 7 20 1 2 6 41 10 2 2450490
           | 1,997 1997 997 97 7 20 1 1 1 2 2 5 2450451
           | 1,997 1997 997 97 7 20 1 1 1 2 2 5 2450451
           | 1,997 1997 997 97 7 20 1 2 6 41 10 2 2450490
           | 1,997 1997 997 97 7 20 1 2 6 41 10 2 2450490
           | 1,997 1997 997 97 7 20 1 2 6 41 10 2 2450490
           | 1,997 1997 997 97 7 20 1 2 6 41 10 2 2450490
           | 1,997 1997 997 97 7 20 2 6 23 161 10 3 2450610
           | 2,001 2001 1 1 1 21 3 9 38 265 22 7 2452175
           | 2,000 2000 0 0 0 20 1 3 11 75 15 4 2451619
           | 2,000 2000 0 0 0 20 1 3 11 75 15 4 2451619
           | 2,000 2000 0 0 0 20 1 3 11 75 15 4 2451619
           | 2,000 2000 0 0 0 20 1 3 11 75 15 4 2451619
           | 2,000 2000 0 0 0 20 1 3 11 75 15 4 2451619
           | 1,997 1997 997 97 7 20 1 2 6 41 10 2 2450490
           | 1,997 1997 997 97 7 20 1 2 6 41 10 2 2450490
           | 1,997 1997 997 97 7 20 1 2 6 41 10 2 2450490
           | 1,997 1997 997 97 7 20 1 2 6 41 10 2 2450490
           | 1,997 1997 997 97 7 20 1 2 6 41 10 2 2450490
           | 1,997 1997 997 97 7 20 1 2 6 41 10 2 2450490
           | 1,997 1997 997 97 7 20 1 2 6 41 10 2 2450490
           | 1,997 1997 997 97 7 20 1 2 6 41 10 2 2450490
           | 1,997 1997 997 97 7 20 1 2 6 41 10 2 2450490
           | 1,997 1997 997 97 7 20 1 2 6 41 10 2 2450490
           | 1,997 1997 997 97 7 20 1 2 6 41 10 2 2450490
           | 1,997 1997 997 97 7 20 1 2 6 41 10 2 2450490
           | 1,997 1997 997 97 7 20 3 7 28 191 10 5 2450640
           | 1,997 1997 997 97 7 20 2 6 23 161 10 3 2450610
           | 1,997 1997 997 97 7 20 1 2 6 41 10 2 2450490
           | 1,997 1997 997 97 7 20 1 2 6 42 11 3 2450491
           | 1,997 1997 997 97 7 20 1 2 7 43 12 4 2450492
           | 1,997 1997 997 97 7 20 1 2 7 44 13 5 2450493
           | 1,997 1997 997 97 7 20 1 2 7 45 14 6 2450494
           | 1,997 1997 997 97 7 20 1 2 7 46 15 7 2450495
           | 1,997 1997 997 97 7 20 1 2 7 47 16 1 2450496
           | 0,097 97 97 97 7 -1 1 2 7 47 16 3 1686042
           | 0,097 97 97 97 7 1 1 2 7 47 16 7 1756536
           | 0,597 597 597 97 7 6 1 2 7 47 16 5 1939157
           | 1,097 1097 97 97 7 11 1 2 7 47 16 3 2121778
           | 1,697 1697 697 97 7 17 1 2 7 47 16 7 2340924
           | 1,797 1797 797 97 7 18 1 2 7 47 16 5 2377448
           | 1,897 1897 897 97 7 19 1 2 7 47 16 3 2413972
           | 1,997 1997 997 97 7 20 1 2 7 47 16 1 2450496
           | 2,097 2097 97 97 7 21 1 2 7 47 16 7 2487021
           | 1,996 1996 996 96 6 20 1 2 9 59 28 4 2450142
           | 1,996 1996 996 96 6 20 1 2 9 60 29 5 2450143
           | 1,996 1996 996 96 6 20 1 3 9 61 1 6 2450144
           | 1,996 1996 996 96 6 20 4 12 53 365 30 2 2450448
           | 1,996 1996 996 96 6 20 4 12 53 366 31 3 2450449
           | 1,997 1997 997 97 7 20 1 1 1 1 1 4 2450450
           | 1,997 1997 997 97 7 20 1 2 9 59 28 6 2450508
           | 1,997 1997 997 97 7 20 1 3 9 60 1 7 2450509
           | 1,997 1997 997 97 7 20 4 12 52 364 30 3 2450813
           | 1,997 1997 997 97 7 20 4 12 53 365 31 4 2450814
           | 1,999 1999 999 99 9 20 4 12 53 365 31 6 2451544
           | 2,000 2000 0 0 0 20 1 1 1 1 1 7 2451545
           | 2,000 2000 0 0 0 20 4 12 53 366 31 1 2451910
           | 2,001 2001 1 1 1 21 1 1 1 1 1 2 2451911
(66 rows)

SELECT '' AS to_char_5, to_char(d1, 'HH HH12 HH24 MI SS SSSS')
   FROM TIMESTAMPTZ_TBL;
 to_char_5 |       to_char        
-----------+----------------------
           | 
           | 
           | 04 04 16 00 00 57600
           | 05 05 17 32 01 63121
           | 05 05 17 32 01 63121
           | 05 05 17 32 02 63122
           | 05 05 17 32 01 63121
           | 05 05 17 32 01 63121
           | 05 05 17 32 01 63121
           | 12 12 00 00 00 0
           | 03 03 03 04 05 11045
           | 05 05 17 32 01 63121
           | 05 05 17 32 01 63121
           | 05 05 17 32 01 63121
           | 05 05 17 32 01 63121
           | 05 05 17 32 01 63121
           | 06 06 18 19 20 65960
           | 08 08 08 14 01 29641
           | 04 04 04 14 02 15242
           | 02 02 02 14 03 8043
           | 03 03 03 14 04 11644
           | 01 01 01 14 05 4445
           | 05 05 17 32 01 63121
           | 05 05 17 32 01 63121
           | 05 05 17 32 00 63120
           | 05 05 17 32 01 63121
           | 05 05 17 32 01 63121
           | 05 05 17 32 01 63121
           | 05 05 17 32 01 63121
           | 05 05 17 32 01 63121
           | 09 09 09 32 01 34321
           | 09 09 09 32 01 34321
           | 09 09 09 32 01 34321
           | 02 02 14 32 01 52321
           | 02 02 14 32 01 52321
           | 06 06 18 32 01 66721
           | 05 05 17 32 01 63121
           | 05 05 17 32 01 63121
           | 05 05 17 32 01 63121
           | 05 05 17 32 01 63121
           | 05 05 17 32 01 63121
           | 05 05 17 32 01 63121
           | 05 05 17 32 01 63121
           | 05 05 17 32 01 63121
           | 05 05 17 32 01 63121
           | 05 05 17 32 01 63121
           | 05 05 17 32 01 63121
           | 05 05 17 32 01 63121
           | 05 05 17 32 01 63121
           | 05 05 17 32 01 63121
           | 05 05 17 32 01 63121
           | 05 05 17 32 01 63121
           | 05 05 17 32 01 63121
           | 05 05 17 32 01 63121
           | 05 05 17 32 01 63121
           | 05 05 17 32 01 63121
           | 05 05 17 32 01 63121
           | 05 05 17 32 01 63121
           | 05 05 17 32 01 63121
           | 05 05 17 32 01 63121
           | 05 05 17 32 01 63121
           | 05 05 17 32 01 63121
           | 05 05 17 32 01 63121
           | 05 05 17 32 01 63121
           | 05 05 17 32 01 63121
           | 05 05 17 32 01 63121
(66 rows)

SELECT '' AS to_char_6, to_char(d1, E'"HH:MI:SS is" HH:MI:SS "\\"text between quote marks\\""')
   FROM TIMESTAMPTZ_TBL;
 to_char_6 |                     to_char                     
-----------+-------------------------------------------------
           | 
           | 
           | HH:MI:SS is 04:00:00 "text between quote marks"
           | HH:MI:SS is 05:32:01 "text between quote marks"
           | HH:MI:SS is 05:32:01 "text between quote marks"
           | HH:MI:SS is 05:32:02 "text between quote marks"
           | HH:MI:SS is 05:32:01 "text between quote marks"
           | HH:MI:SS is 05:32:01 "text between quote marks"
           | HH:MI:SS is 05:32:01 "text between quote marks"
           | HH:MI:SS is 12:00:00 "text between quote marks"
           | HH:MI:SS is 03:04:05 "text between quote marks"
           | HH:MI:SS is 05:32:01 "text between quote marks"
           | HH:MI:SS is 05:32:01 "text between quote marks"
           | HH:MI:SS is 05:32:01 "text between quote marks"
           | HH:MI:SS is 05:32:01 "text between quote marks"
           | HH:MI:SS is 05:32:01 "text between quote marks"
           | HH:MI:SS is 06:19:20 "text between quote marks"
           | HH:MI:SS is 08:14:01 "text between quote marks"
           | HH:MI:SS is 04:14:02 "text between quote marks"
           | HH:MI:SS is 02:14:03 "text between quote marks"
           | HH:MI:SS is 03:14:04 "text between quote marks"
           | HH:MI:SS is 01:14:05 "text between quote marks"
           | HH:MI:SS is 05:32:01 "text between quote marks"
           | HH:MI:SS is 05:32:01 "text between quote marks"
           | HH:MI:SS is 05:32:00 "text between quote marks"
           | HH:MI:SS is 05:32:01 "text between quote marks"
           | HH:MI:SS is 05:32:01 "text between quote marks"
           | HH:MI:SS is 05:32:01 "text between quote marks"
           | HH:MI:SS is 05:32:01 "text between quote marks"
           | HH:MI:SS is 05:32:01 "text between quote marks"
           | HH:MI:SS is 09:32:01 "text between quote marks"
           | HH:MI:SS is 09:32:01 "text between quote marks"
           | HH:MI:SS is 09:32:01 "text between quote marks"
           | HH:MI:SS is 02:32:01 "text between quote marks"
           | HH:MI:SS is 02:32:01 "text between quote marks"
           | HH:MI:SS is 06:32:01 "text between quote marks"
           | HH:MI:SS is 05:32:01 "text between quote marks"
           | HH:MI:SS is 05:32:01 "text between quote marks"
           | HH:MI:SS is 05:32:01 "text between quote marks"
           | HH:MI:SS is 05:32:01 "text between quote marks"
           | HH:MI:SS is 05:32:01 "text between quote marks"
           | HH:MI:SS is 05:32:01 "text between quote marks"
           | HH:MI:SS is 05:32:01 "text between quote marks"
           | HH:MI:SS is 05:32:01 "text between quote marks"
           | HH:MI:SS is 05:32:01 "text between quote marks"
           | HH:MI:SS is 05:32:01 "text between quote marks"
           | HH:MI:SS is 05:32:01 "text between quote marks"
           | HH:MI:SS is 05:32:01 "text between quote marks"
           | HH:MI:SS is 05:32:01 "text between quote marks"
           | HH:MI:SS is 05:32:01 "text between quote marks"
           | HH:MI:SS is 05:32:01 "text between quote marks"
           | HH:MI:SS is 05:32:01 "text between quote marks"
           | HH:MI:SS is 05:32:01 "text between quote marks"
           | HH:MI:SS is 05:32:01 "text between quote marks"
           | HH:MI:SS is 05:32:01 "text between quote marks"
           | HH:MI:SS is 05:32:01 "text between quote marks"
           | HH:MI:SS is 05:32:01 "text between quote marks"
           | HH:MI:SS is 05:32:01 "text between quote marks"
           | HH:MI:SS is 05:32:01 "text between quote marks"
           | HH:MI:SS is 05:32:01 "text between quote marks"
           | HH:MI:SS is 05:32:01 "text between quote marks"
           | HH:MI:SS is 05:32:01 "text between quote marks"
           | HH:MI:SS is 05:32:01 "text between quote marks"
           | HH:MI:SS is 05:32:01 "text between quote marks"
           | HH:MI:SS is 05:32:01 "text between quote marks"
           | HH:MI:SS is 05:32:01 "text between quote marks"
(66 rows)

SELECT '' AS to_char_7, to_char(d1, 'HH24--text--MI--text--SS')
   FROM TIMESTAMPTZ_TBL;
 to_char_7 |        to_char         
-----------+------------------------
           | 
           | 
           | 16--text--00--text--00
           | 17--text--32--text--01
           | 17--text--32--text--01
           | 17--text--32--text--02
           | 17--text--32--text--01
           | 17--text--32--text--01
           | 17--text--32--text--01
           | 00--text--00--text--00
           | 03--text--04--text--05
           | 17--text--32--text--01
           | 17--text--32--text--01
           | 17--text--32--text--01
           | 17--text--32--text--01
           | 17--text--32--text--01
           | 18--text--19--text--20
           | 08--text--14--text--01
           | 04--text--14--text--02
           | 02--text--14--text--03
           | 03--text--14--text--04
           | 01--text--14--text--05
           | 17--text--32--text--01
           | 17--text--32--text--01
           | 17--text--32--text--00
           | 17--text--32--text--01
           | 17--text--32--text--01
           | 17--text--32--text--01
           | 17--text--32--text--01
           | 17--text--32--text--01
           | 09--text--32--text--01
           | 09--text--32--text--01
           | 09--text--32--text--01
           | 14--text--32--text--01
           | 14--text--32--text--01
           | 18--text--32--text--01
           | 17--text--32--text--01
           | 17--text--32--text--01
           | 17--text--32--text--01
           | 17--text--32--text--01
           | 17--text--32--text--01
           | 17--text--32--text--01
           | 17--text--32--text--01
           | 17--text--32--text--01
           | 17--text--32--text--01
           | 17--text--32--text--01
           | 17--text--32--text--01
           | 17--text--32--text--01
           | 17--text--32--text--01
           | 17--text--32--text--01
           | 17--text--32--text--01
           | 17--text--32--text--01
           | 17--text--32--text--01
           | 17--text--32--text--01
           | 17--text--32--text--01
           | 17--text--32--text--01
           | 17--text--32--text--01
           | 17--text--32--text--01
           | 17--text--32--text--01
           | 17--text--32--text--01
           | 17--text--32--text--01
           | 17--text--32--text--01
           | 17--text--32--text--01
           | 17--text--32--text--01
           | 17--text--32--text--01
           | 17--text--32--text--01
(66 rows)

SELECT '' AS to_char_8, to_char(d1, 'YYYYTH YYYYth Jth')
   FROM TIMESTAMPTZ_TBL;
 to_char_8 |         to_char         
-----------+-------------------------
           | 
           | 
           | 1969TH 1969th 2440587th
           | 1997TH 1997th 2450490th
           | 1997TH 1997th 2450490th
           | 1997TH 1997th 2450490th
           | 1997TH 1997th 2450490th
           | 1997TH 1997th 2450490th
           | 1997TH 1997th 2450490th
           | 1997TH 1997th 2450451st
           | 1997TH 1997th 2450451st
           | 1997TH 1997th 2450490th
           | 1997TH 1997th 2450490th
           | 1997TH 1997th 2450490th
           | 1997TH 1997th 2450490th
           | 1997TH 1997th 2450610th
           | 2001ST 2001st 2452175th
           | 2000TH 2000th 2451619th
           | 2000TH 2000th 2451619th
           | 2000TH 2000th 2451619th
           | 2000TH 2000th 2451619th
           | 2000TH 2000th 2451619th
           | 1997TH 1997th 2450490th
           | 1997TH 1997th 2450490th
           | 1997TH 1997th 2450490th
           | 1997TH 1997th 2450490th
           | 1997TH 1997th 2450490th
           | 1997TH 1997th 2450490th
           | 1997TH 1997th 2450490th
           | 1997TH 1997th 2450490th
           | 1997TH 1997th 2450490th
           | 1997TH 1997th 2450490th
           | 1997TH 1997th 2450490th
           | 1997TH 1997th 2450490th
           | 1997TH 1997th 2450640th
           | 1997TH 1997th 2450610th
           | 1997TH 1997th 2450490th
           | 1997TH 1997th 2450491st
           | 1997TH 1997th 2450492nd
           | 1997TH 1997th 2450493rd
           | 1997TH 1997th 2450494th
           | 1997TH 1997th 2450495th
           | 1997TH 1997th 2450496th
           | 0097TH 0097th 1686042nd
           | 0097TH 0097th 1756536th
           | 0597TH 0597th 1939157th
           | 1097TH 1097th 2121778th
           | 1697TH 1697th 2340924th
           | 1797TH 1797th 2377448th
           | 1897TH 1897th 2413972nd
           | 1997TH 1997th 2450496th
           | 2097TH 2097th 2487021st
           | 1996TH 1996th 2450142nd
           | 1996TH 1996th 2450143rd
           | 1996TH 1996th 2450144th
           | 1996TH 1996th 2450448th
           | 1996TH 1996th 2450449th
           | 1997TH 1997th 2450450th
           | 1997TH 1997th 2450508th
           | 1997TH 1997th 2450509th
           | 1997TH 1997th 2450813th
           | 1997TH 1997th 2450814th
           | 1999TH 1999th 2451544th
           | 2000TH 2000th 2451545th
           | 2000TH 2000th 2451910th
           | 2001ST 2001st 2451911th
(66 rows)

SELECT '' AS to_char_9, to_char(d1, 'YYYY A.D. YYYY a.d. YYYY bc HH:MI:SS P.M. HH:MI:SS p.m. HH:MI:SS pm')
   FROM TIMESTAMPTZ_TBL;
 to_char_9 |                               to_char                               
-----------+---------------------------------------------------------------------
           | 
           | 
           | 1969 A.D. 1969 a.d. 1969 ad 04:00:00 P.M. 04:00:00 p.m. 04:00:00 pm
           | 1997 A.D. 1997 a.d. 1997 ad 05:32:01 P.M. 05:32:01 p.m. 05:32:01 pm
           | 1997 A.D. 1997 a.d. 1997 ad 05:32:01 P.M. 05:32:01 p.m. 05:32:01 pm
           | 1997 A.D. 1997 a.d. 1997 ad 05:32:02 P.M. 05:32:02 p.m. 05:32:02 pm
           | 1997 A.D. 1997 a.d. 1997 ad 05:32:01 P.M. 05:32:01 p.m. 05:32:01 pm
           | 1997 A.D. 1997 a.d. 1997 ad 05:32:01 P.M. 05:32:01 p.m. 05:32:01 pm
           | 1997 A.D. 1997 a.d. 1997 ad 05:32:01 P.M. 05:32:01 p.m. 05:32:01 pm
           | 1997 A.D. 1997 a.d. 1997 ad 12:00:00 A.M. 12:00:00 a.m. 12:00:00 am
           | 1997 A.D. 1997 a.d. 1997 ad 03:04:05 A.M. 03:04:05 a.m. 03:04:05 am
           | 1997 A.D. 1997 a.d. 1997 ad 05:32:01 P.M. 05:32:01 p.m. 05:32:01 pm
           | 1997 A.D. 1997 a.d. 1997 ad 05:32:01 P.M. 05:32:01 p.m. 05:32:01 pm
           | 1997 A.D. 1997 a.d. 1997 ad 05:32:01 P.M. 05:32:01 p.m. 05:32:01 pm
           | 1997 A.D. 1997 a.d. 1997 ad 05:32:01 P.M. 05:32:01 p.m. 05:32:01 pm
           | 1997 A.D. 1997 a.d. 1997 ad 05:32:01 P.M. 05:32:01 p.m. 05:32:01 pm
           | 2001 A.D. 2001 a.d. 2001 ad 06:19:20 P.M. 06:19:20 p.m. 06:19:20 pm
           | 2000 A.D. 2000 a.d. 2000 ad 08:14:01 A.M. 08:14:01 a.m. 08:14:01 am
           | 2000 A.D. 2000 a.d. 2000 ad 04:14:02 A.M. 04:14:02 a.m. 04:14:02 am
           | 2000 A.D. 2000 a.d. 2000 ad 02:14:03 A.M. 02:14:03 a.m. 02:14:03 am
           | 2000 A.D. 2000 a.d. 2000 ad 03:14:04 A.M. 03:14:04 a.m. 03:14:04 am
           | 2000 A.D. 2000 a.d. 2000 ad 01:14:05 A.M. 01:14:05 a.m. 01:14:05 am
           | 1997 A.D. 1997 a.d. 1997 ad 05:32:01 P.M. 05:32:01 p.m. 05:32:01 pm
           | 1997 A.D. 1997 a.d. 1997 ad 05:32:01 P.M. 05:32:01 p.m. 05:32:01 pm
           | 1997 A.D. 1997 a.d. 1997 ad 05:32:00 P.M. 05:32:00 p.m. 05:32:00 pm
           | 1997 A.D. 1997 a.d. 1997 ad 05:32:01 P.M. 05:32:01 p.m. 05:32:01 pm
           | 1997 A.D. 1997 a.d. 1997 ad 05:32:01 P.M. 05:32:01 p.m. 05:32:01 pm
           | 1997 A.D. 1997 a.d. 1997 ad 05:32:01 P.M. 05:32:01 p.m. 05:32:01 pm
           | 1997 A.D. 1997 a.d. 1997 ad 05:32:01 P.M. 05:32:01 p.m. 05:32:01 pm
           | 1997 A.D. 1997 a.d. 1997 ad 05:32:01 P.M. 05:32:01 p.m. 05:32:01 pm
           | 1997 A.D. 1997 a.d. 1997 ad 09:32:01 A.M. 09:32:01 a.m. 09:32:01 am
           | 1997 A.D. 1997 a.d. 1997 ad 09:32:01 A.M. 09:32:01 a.m. 09:32:01 am
           | 1997 A.D. 1997 a.d. 1997 ad 09:32:01 A.M. 09:32:01 a.m. 09:32:01 am
           | 1997 A.D. 1997 a.d. 1997 ad 02:32:01 P.M. 02:32:01 p.m. 02:32:01 pm
           | 1997 A.D. 1997 a.d. 1997 ad 02:32:01 P.M. 02:32:01 p.m. 02:32:01 pm
           | 1997 A.D. 1997 a.d. 1997 ad 06:32:01 P.M. 06:32:01 p.m. 06:32:01 pm
           | 1997 A.D. 1997 a.d. 1997 ad 05:32:01 P.M. 05:32:01 p.m. 05:32:01 pm
           | 1997 A.D. 1997 a.d. 1997 ad 05:32:01 P.M. 05:32:01 p.m. 05:32:01 pm
           | 1997 A.D. 1997 a.d. 1997 ad 05:32:01 P.M. 05:32:01 p.m. 05:32:01 pm
           | 1997 A.D. 1997 a.d. 1997 ad 05:32:01 P.M. 05:32:01 p.m. 05:32:01 pm
           | 1997 A.D. 1997 a.d. 1997 ad 05:32:01 P.M. 05:32:01 p.m. 05:32:01 pm
           | 1997 A.D. 1997 a.d. 1997 ad 05:32:01 P.M. 05:32:01 p.m. 05:32:01 pm
           | 1997 A.D. 1997 a.d. 1997 ad 05:32:01 P.M. 05:32:01 p.m. 05:32:01 pm
           | 0097 B.C. 0097 b.c. 0097 bc 05:32:01 P.M. 05:32:01 p.m. 05:32:01 pm
           | 0097 A.D. 0097 a.d. 0097 ad 05:32:01 P.M. 05:32:01 p.m. 05:32:01 pm
           | 0597 A.D. 0597 a.d. 0597 ad 05:32:01 P.M. 05:32:01 p.m. 05:32:01 pm
           | 1097 A.D. 1097 a.d. 1097 ad 05:32:01 P.M. 05:32:01 p.m. 05:32:01 pm
           | 1697 A.D. 1697 a.d. 1697 ad 05:32:01 P.M. 05:32:01 p.m. 05:32:01 pm
           | 1797 A.D. 1797 a.d. 1797 ad 05:32:01 P.M. 05:32:01 p.m. 05:32:01 pm
           | 1897 A.D. 1897 a.d. 1897 ad 05:32:01 P.M. 05:32:01 p.m. 05:32:01 pm
           | 1997 A.D. 1997 a.d. 1997 ad 05:32:01 P.M. 05:32:01 p.m. 05:32:01 pm
           | 2097 A.D. 2097 a.d. 2097 ad 05:32:01 P.M. 05:32:01 p.m. 05:32:01 pm
           | 1996 A.D. 1996 a.d. 1996 ad 05:32:01 P.M. 05:32:01 p.m. 05:32:01 pm
           | 1996 A.D. 1996 a.d. 1996 ad 05:32:01 P.M. 05:32:01 p.m. 05:32:01 pm
           | 1996 A.D. 1996 a.d. 1996 ad 05:32:01 P.M. 05:32:01 p.m. 05:32:01 pm
           | 1996 A.D. 1996 a.d. 1996 ad 05:32:01 P.M. 05:32:01 p.m. 05:32:01 pm
           | 1996 A.D. 1996 a.d. 1996 ad 05:32:01 P.M. 05:32:01 p.m. 05:32:01 pm
           | 1997 A.D. 1997 a.d. 1997 ad 05:32:01 P.M. 05:32:01 p.m. 05:32:01 pm
           | 1997 A.D. 1997 a.d. 1997 ad 05:32:01 P.M. 05:32:01 p.m. 05:32:01 pm
           | 1997 A.D. 1997 a.d. 1997 ad 05:32:01 P.M. 05:32:01 p.m. 05:32:01 pm
           | 1997 A.D. 1997 a.d. 1997 ad 05:32:01 P.M. 05:32:01 p.m. 05:32:01 pm
           | 1997 A.D. 1997 a.d. 1997 ad 05:32:01 P.M. 05:32:01 p.m. 05:32:01 pm
           | 1999 A.D. 1999 a.d. 1999 ad 05:32:01 P.M. 05:32:01 p.m. 05:32:01 pm
           | 2000 A.D. 2000 a.d. 2000 ad 05:32:01 P.M. 05:32:01 p.m. 05:32:01 pm
           | 2000 A.D. 2000 a.d. 2000 ad 05:32:01 P.M. 05:32:01 p.m. 05:32:01 pm
           | 2001 A.D. 2001 a.d. 2001 ad 05:32:01 P.M. 05:32:01 p.m. 05:32:01 pm
(66 rows)

SELECT '' AS to_char_10, to_char(d1, 'IYYY IYY IY I IW IDDD ID')
   FROM TIMESTAMPTZ_TBL;
 to_char_10 |        to_char         
------------+------------------------
            | 
            | 
            | 1970 970 70 0 01 003 3
            | 1997 997 97 7 07 043 1
            | 1997 997 97 7 07 043 1
            | 1997 997 97 7 07 043 1
            | 1997 997 97 7 07 043 1
            | 1997 997 97 7 07 043 1
            | 1997 997 97 7 07 043 1
            | 1997 997 97 7 01 004 4
            | 1997 997 97 7 01 004 4
            | 1997 997 97 7 07 043 1
            | 1997 997 97 7 07 043 1
            | 1997 997 97 7 07 043 1
            | 1997 997 97 7 07 043 1
            | 1997 997 97 7 24 163 2
            | 2001 001 01 1 38 265 6
            | 2000 000 00 0 11 073 3
            | 2000 000 00 0 11 073 3
            | 2000 000 00 0 11 073 3
            | 2000 000 00 0 11 073 3
            | 2000 000 00 0 11 073 3
            | 1997 997 97 7 07 043 1
            | 1997 997 97 7 07 043 1
            | 1997 997 97 7 07 043 1
            | 1997 997 97 7 07 043 1
            | 1997 997 97 7 07 043 1
            | 1997 997 97 7 07 043 1
            | 1997 997 97 7 07 043 1
            | 1997 997 97 7 07 043 1
            | 1997 997 97 7 07 043 1
            | 1997 997 97 7 07 043 1
            | 1997 997 97 7 07 043 1
            | 1997 997 97 7 07 043 1
            | 1997 997 97 7 28 193 4
            | 1997 997 97 7 24 163 2
            | 1997 997 97 7 07 043 1
            | 1997 997 97 7 07 044 2
            | 1997 997 97 7 07 045 3
            | 1997 997 97 7 07 046 4
            | 1997 997 97 7 07 047 5
            | 1997 997 97 7 07 048 6
            | 1997 997 97 7 07 049 7
            | 0097 097 97 7 07 044 2
            | 0097 097 97 7 07 048 6
            | 0597 597 97 7 07 046 4
            | 1097 097 97 7 07 044 2
            | 1697 697 97 7 07 048 6
            | 1797 797 97 7 07 046 4
            | 1897 897 97 7 07 044 2
            | 1997 997 97 7 07 049 7
            | 2097 097 97 7 07 048 6
            | 1996 996 96 6 09 059 3
            | 1996 996 96 6 09 060 4
            | 1996 996 96 6 09 061 5
            | 1997 997 97 7 01 001 1
            | 1997 997 97 7 01 002 2
            | 1997 997 97 7 01 003 3
            | 1997 997 97 7 09 061 5
            | 1997 997 97 7 09 062 6
            | 1998 998 98 8 01 002 2
            | 1998 998 98 8 01 003 3
            | 1999 999 99 9 52 362 5
            | 1999 999 99 9 52 363 6
            | 2000 000 00 0 52 364 7
            | 2001 001 01 1 01 001 1
(66 rows)

SELECT '' AS to_char_11, to_char(d1, 'FMIYYY FMIYY FMIY FMI FMIW FMIDDD FMID')
   FROM TIMESTAMPTZ_TBL;
 to_char_11 |        to_char         
------------+------------------------
            | 
            | 
            | 1970 970 70 0 1 3 3
            | 1997 997 97 7 7 43 1
            | 1997 997 97 7 7 43 1
            | 1997 997 97 7 7 43 1
            | 1997 997 97 7 7 43 1
            | 1997 997 97 7 7 43 1
            | 1997 997 97 7 7 43 1
            | 1997 997 97 7 1 4 4
            | 1997 997 97 7 1 4 4
            | 1997 997 97 7 7 43 1
            | 1997 997 97 7 7 43 1
            | 1997 997 97 7 7 43 1
            | 1997 997 97 7 7 43 1
            | 1997 997 97 7 24 163 2
            | 2001 1 1 1 38 265 6
            | 2000 0 0 0 11 73 3
            | 2000 0 0 0 11 73 3
            | 2000 0 0 0 11 73 3
            | 2000 0 0 0 11 73 3
            | 2000 0 0 0 11 73 3
            | 1997 997 97 7 7 43 1
            | 1997 997 97 7 7 43 1
            | 1997 997 97 7 7 43 1
            | 1997 997 97 7 7 43 1
            | 1997 997 97 7 7 43 1
            | 1997 997 97 7 7 43 1
            | 1997 997 97 7 7 43 1
            | 1997 997 97 7 7 43 1
            | 1997 997 97 7 7 43 1
            | 1997 997 97 7 7 43 1
            | 1997 997 97 7 7 43 1
            | 1997 997 97 7 7 43 1
            | 1997 997 97 7 28 193 4
            | 1997 997 97 7 24 163 2
            | 1997 997 97 7 7 43 1
            | 1997 997 97 7 7 44 2
            | 1997 997 97 7 7 45 3
            | 1997 997 97 7 7 46 4
            | 1997 997 97 7 7 47 5
            | 1997 997 97 7 7 48 6
            | 1997 997 97 7 7 49 7
            | 97 97 97 7 7 44 2
            | 97 97 97 7 7 48 6
            | 597 597 97 7 7 46 4
            | 1097 97 97 7 7 44 2
            | 1697 697 97 7 7 48 6
            | 1797 797 97 7 7 46 4
            | 1897 897 97 7 7 44 2
            | 1997 997 97 7 7 49 7
            | 2097 97 97 7 7 48 6
            | 1996 996 96 6 9 59 3
            | 1996 996 96 6 9 60 4
            | 1996 996 96 6 9 61 5
            | 1997 997 97 7 1 1 1
            | 1997 997 97 7 1 2 2
            | 1997 997 97 7 1 3 3
            | 1997 997 97 7 9 61 5
            | 1997 997 97 7 9 62 6
            | 1998 998 98 8 1 2 2
            | 1998 998 98 8 1 3 3
            | 1999 999 99 9 52 362 5
            | 1999 999 99 9 52 363 6
            | 2000 0 0 0 52 364 7
            | 2001 1 1 1 1 1 1
(66 rows)

-- Check OF with various zone offsets, particularly fractional hours
SET timezone = '00:00';
SELECT to_char(now(), 'OF');
 to_char 
---------
 +00
(1 row)

SET timezone = '+02:00';
SELECT to_char(now(), 'OF');
 to_char 
---------
 -02
(1 row)

SET timezone = '-13:00';
SELECT to_char(now(), 'OF');
 to_char 
---------
 +13
(1 row)

SET timezone = '-00:30';
SELECT to_char(now(), 'OF');
 to_char 
---------
 +00:30
(1 row)

SET timezone = '00:30';
SELECT to_char(now(), 'OF');
 to_char 
---------
 -00:30
(1 row)

SET timezone = '-04:30';
SELECT to_char(now(), 'OF');
 to_char 
---------
 +04:30
(1 row)

SET timezone = '04:30';
SELECT to_char(now(), 'OF');
 to_char 
---------
 -04:30
(1 row)

RESET timezone;
CREATE TABLE TIMESTAMPTZ_TST (a int , b timestamptz);
-- Test year field value with len > 4
INSERT INTO TIMESTAMPTZ_TST VALUES(1, 'Sat Mar 12 23:58:48 1000 IST');
INSERT INTO TIMESTAMPTZ_TST VALUES(2, 'Sat Mar 12 23:58:48 10000 IST');
INSERT INTO TIMESTAMPTZ_TST VALUES(3, 'Sat Mar 12 23:58:48 100000 IST');
INSERT INTO TIMESTAMPTZ_TST VALUES(3, '10000 Mar 12 23:58:48 IST');
INSERT INTO TIMESTAMPTZ_TST VALUES(4, '100000312 23:58:48 IST');
INSERT INTO TIMESTAMPTZ_TST VALUES(4, '1000000312 23:58:48 IST');
--Verify data
SELECT * FROM TIMESTAMPTZ_TST ORDER BY a;
 a |               b                
---+--------------------------------
 1 | Wed Mar 12 13:58:48 1000 PST
 2 | Sun Mar 12 14:58:48 10000 PDT
 3 | Sun Mar 12 14:58:48 100000 PDT
 3 | Sun Mar 12 14:58:48 10000 PDT
 4 | Sun Mar 12 14:58:48 10000 PDT
 4 | Sun Mar 12 14:58:48 100000 PDT
(6 rows)

--Cleanup
DROP TABLE TIMESTAMPTZ_TST;
-- test timestamptz constructors
set TimeZone to 'America/Santiago';
-- numeric timezone
SELECT make_timestamptz(1973, 07, 15, 08, 15, 55.33);
        make_timestamptz         
---------------------------------
 Sun Jul 15 08:15:55.33 1973 CLT
(1 row)

SELECT make_timestamptz(1973, 07, 15, 08, 15, 55.33, '+2');
        make_timestamptz         
---------------------------------
 Sun Jul 15 02:15:55.33 1973 CLT
(1 row)

SELECT make_timestamptz(1973, 07, 15, 08, 15, 55.33, '-2');
        make_timestamptz         
---------------------------------
 Sun Jul 15 06:15:55.33 1973 CLT
(1 row)

WITH tzs (tz) AS (VALUES
    ('+1'), ('+1:'), ('+1:0'), ('+100'), ('+1:00'), ('+01:00'),
    ('+10'), ('+1000'), ('+10:'), ('+10:0'), ('+10:00'), ('+10:00:'),
    ('+10:00:1'), ('+10:00:01'),
    ('+10:00:10'))
     SELECT make_timestamptz(2010, 2, 27, 3, 45, 00, tz), tz FROM tzs;
       make_timestamptz        |    tz     
-------------------------------+-----------
 Fri Feb 26 23:45:00 2010 CLST | +1
 Fri Feb 26 23:45:00 2010 CLST | +1:
 Fri Feb 26 23:45:00 2010 CLST | +1:0
 Fri Feb 26 23:45:00 2010 CLST | +100
 Fri Feb 26 23:45:00 2010 CLST | +1:00
 Fri Feb 26 23:45:00 2010 CLST | +01:00
 Fri Feb 26 14:45:00 2010 CLST | +10
 Fri Feb 26 14:45:00 2010 CLST | +1000
 Fri Feb 26 14:45:00 2010 CLST | +10:
 Fri Feb 26 14:45:00 2010 CLST | +10:0
 Fri Feb 26 14:45:00 2010 CLST | +10:00
 Fri Feb 26 14:45:00 2010 CLST | +10:00:
 Fri Feb 26 14:44:59 2010 CLST | +10:00:1
 Fri Feb 26 14:44:59 2010 CLST | +10:00:01
 Fri Feb 26 14:44:50 2010 CLST | +10:00:10
(15 rows)

-- these should fail
SELECT make_timestamptz(1973, 07, 15, 08, 15, 55.33, '2');
ERROR:  invalid input syntax for numeric time zone: "2"
HINT:  Numeric time zones must have "-" or "+" as first character.
SELECT make_timestamptz(2014, 12, 10, 10, 10, 10, '+16');
ERROR:  numeric time zone "+16" out of range
SELECT make_timestamptz(2014, 12, 10, 10, 10, 10, '-16');
ERROR:  numeric time zone "-16" out of range
-- should be true
SELECT make_timestamptz(1973, 07, 15, 08, 15, 55.33, '+2') = '1973-07-15 08:15:55.33+02'::timestamptz;
 ?column? 
----------
 t
(1 row)

-- full timezone names
SELECT make_timestamptz(2014, 12, 10, 0, 0, 0, 'Europe/Prague') = timestamptz '2014-12-10 00:00:00 Europe/Prague';
 ?column? 
----------
 t
(1 row)

SELECT make_timestamptz(2014, 12, 10, 0, 0, 0, 'Europe/Prague') AT TIME ZONE 'UTC';
         timezone         
--------------------------
 Tue Dec 09 23:00:00 2014
(1 row)

SELECT make_timestamptz(1846, 12, 10, 0, 0, 0, 'Asia/Manila') AT TIME ZONE 'UTC';
         timezone         
--------------------------
 Wed Dec 09 15:56:00 1846
(1 row)

SELECT make_timestamptz(1881, 12, 10, 0, 0, 0, 'Europe/Paris') AT TIME ZONE 'UTC';
         timezone         
--------------------------
 Fri Dec 09 23:50:39 1881
(1 row)

SELECT make_timestamptz(1910, 12, 24, 0, 0, 0, 'Nehwon/Lankhmar');
ERROR:  time zone "Nehwon/Lankhmar" not recognized
-- abbreviations
SELECT make_timestamptz(2008, 12, 10, 10, 10, 10, 'CLST');
       make_timestamptz        
-------------------------------
 Wed Dec 10 10:10:10 2008 CLST
(1 row)

SELECT make_timestamptz(2008, 12, 10, 10, 10, 10, 'CLT');
       make_timestamptz        
-------------------------------
 Wed Dec 10 11:10:10 2008 CLST
(1 row)

SELECT make_timestamptz(2014, 12, 10, 10, 10, 10, 'PST8PDT');
       make_timestamptz        
-------------------------------
 Wed Dec 10 15:10:10 2014 CLST
(1 row)

RESET TimeZone;
--
-- Test behavior with a dynamic (time-varying) timezone abbreviation.
-- These tests rely on the knowledge that MSK (Europe/Moscow standard time)
-- moved forwards in Mar 2011 and that VET (America/Caracas standard time)
-- moved backwards in Dec 2007.
--
SET TimeZone to 'UTC';
SELECT '2011-03-27 00:00:00 Europe/Moscow'::timestamptz;
         timestamptz          
------------------------------
 Sat Mar 26 21:00:00 2011 UTC
(1 row)

SELECT '2011-03-27 01:00:00 Europe/Moscow'::timestamptz;
         timestamptz          
------------------------------
 Sat Mar 26 22:00:00 2011 UTC
(1 row)

SELECT '2011-03-27 01:59:59 Europe/Moscow'::timestamptz;
         timestamptz          
------------------------------
 Sat Mar 26 22:59:59 2011 UTC
(1 row)

SELECT '2011-03-27 02:00:00 Europe/Moscow'::timestamptz;
         timestamptz          
------------------------------
 Sat Mar 26 23:00:00 2011 UTC
(1 row)

SELECT '2011-03-27 02:00:01 Europe/Moscow'::timestamptz;
         timestamptz          
------------------------------
 Sat Mar 26 23:00:01 2011 UTC
(1 row)

SELECT '2011-03-27 02:59:59 Europe/Moscow'::timestamptz;
         timestamptz          
------------------------------
 Sat Mar 26 23:59:59 2011 UTC
(1 row)

SELECT '2011-03-27 03:00:00 Europe/Moscow'::timestamptz;
         timestamptz          
------------------------------
 Sat Mar 26 23:00:00 2011 UTC
(1 row)

SELECT '2011-03-27 03:00:01 Europe/Moscow'::timestamptz;
         timestamptz          
------------------------------
 Sat Mar 26 23:00:01 2011 UTC
(1 row)

SELECT '2011-03-27 04:00:00 Europe/Moscow'::timestamptz;
         timestamptz          
------------------------------
 Sun Mar 27 00:00:00 2011 UTC
(1 row)

SELECT '2011-03-27 00:00:00 MSK'::timestamptz;
         timestamptz          
------------------------------
 Sat Mar 26 21:00:00 2011 UTC
(1 row)

SELECT '2011-03-27 01:00:00 MSK'::timestamptz;
         timestamptz          
------------------------------
 Sat Mar 26 22:00:00 2011 UTC
(1 row)

SELECT '2011-03-27 01:59:59 MSK'::timestamptz;
         timestamptz          
------------------------------
 Sat Mar 26 22:59:59 2011 UTC
(1 row)

SELECT '2011-03-27 02:00:00 MSK'::timestamptz;
         timestamptz          
------------------------------
 Sat Mar 26 22:00:00 2011 UTC
(1 row)

SELECT '2011-03-27 02:00:01 MSK'::timestamptz;
         timestamptz          
------------------------------
 Sat Mar 26 22:00:01 2011 UTC
(1 row)

SELECT '2011-03-27 02:59:59 MSK'::timestamptz;
         timestamptz          
------------------------------
 Sat Mar 26 22:59:59 2011 UTC
(1 row)

SELECT '2011-03-27 03:00:00 MSK'::timestamptz;
         timestamptz          
------------------------------
 Sat Mar 26 23:00:00 2011 UTC
(1 row)

SELECT '2011-03-27 03:00:01 MSK'::timestamptz;
         timestamptz          
------------------------------
 Sat Mar 26 23:00:01 2011 UTC
(1 row)

SELECT '2011-03-27 04:00:00 MSK'::timestamptz;
         timestamptz          
------------------------------
 Sun Mar 27 00:00:00 2011 UTC
(1 row)

SELECT '2007-12-09 02:00:00 America/Caracas'::timestamptz;
         timestamptz          
------------------------------
 Sun Dec 09 06:00:00 2007 UTC
(1 row)

SELECT '2007-12-09 02:29:59 America/Caracas'::timestamptz;
         timestamptz          
------------------------------
 Sun Dec 09 06:29:59 2007 UTC
(1 row)

SELECT '2007-12-09 02:30:00 America/Caracas'::timestamptz;
         timestamptz          
------------------------------
 Sun Dec 09 07:00:00 2007 UTC
(1 row)

SELECT '2007-12-09 02:30:01 America/Caracas'::timestamptz;
         timestamptz          
------------------------------
 Sun Dec 09 07:00:01 2007 UTC
(1 row)

SELECT '2007-12-09 02:59:59 America/Caracas'::timestamptz;
         timestamptz          
------------------------------
 Sun Dec 09 07:29:59 2007 UTC
(1 row)

SELECT '2007-12-09 03:00:00 America/Caracas'::timestamptz;
         timestamptz          
------------------------------
 Sun Dec 09 07:30:00 2007 UTC
(1 row)

SELECT '2007-12-09 03:00:01 America/Caracas'::timestamptz;
         timestamptz          
------------------------------
 Sun Dec 09 07:30:01 2007 UTC
(1 row)

SELECT '2007-12-09 04:00:00 America/Caracas'::timestamptz;
         timestamptz          
------------------------------
 Sun Dec 09 08:30:00 2007 UTC
(1 row)

SELECT '2007-12-09 02:00:00 VET'::timestamptz;
         timestamptz          
------------------------------
 Sun Dec 09 06:00:00 2007 UTC
(1 row)

SELECT '2007-12-09 02:29:59 VET'::timestamptz;
         timestamptz          
------------------------------
 Sun Dec 09 06:29:59 2007 UTC
(1 row)

SELECT '2007-12-09 02:30:00 VET'::timestamptz;
         timestamptz          
------------------------------
 Sun Dec 09 07:00:00 2007 UTC
(1 row)

SELECT '2007-12-09 02:30:01 VET'::timestamptz;
         timestamptz          
------------------------------
 Sun Dec 09 07:00:01 2007 UTC
(1 row)

SELECT '2007-12-09 02:59:59 VET'::timestamptz;
         timestamptz          
------------------------------
 Sun Dec 09 07:29:59 2007 UTC
(1 row)

SELECT '2007-12-09 03:00:00 VET'::timestamptz;
         timestamptz          
------------------------------
 Sun Dec 09 07:30:00 2007 UTC
(1 row)

SELECT '2007-12-09 03:00:01 VET'::timestamptz;
         timestamptz          
------------------------------
 Sun Dec 09 07:30:01 2007 UTC
(1 row)

SELECT '2007-12-09 04:00:00 VET'::timestamptz;
         timestamptz          
------------------------------
 Sun Dec 09 08:30:00 2007 UTC
(1 row)

SELECT '2011-03-27 00:00:00'::timestamp AT TIME ZONE 'Europe/Moscow';
           timezone           
------------------------------
 Sat Mar 26 21:00:00 2011 UTC
(1 row)

SELECT '2011-03-27 01:00:00'::timestamp AT TIME ZONE 'Europe/Moscow';
           timezone           
------------------------------
 Sat Mar 26 22:00:00 2011 UTC
(1 row)

SELECT '2011-03-27 01:59:59'::timestamp AT TIME ZONE 'Europe/Moscow';
           timezone           
------------------------------
 Sat Mar 26 22:59:59 2011 UTC
(1 row)

SELECT '2011-03-27 02:00:00'::timestamp AT TIME ZONE 'Europe/Moscow';
           timezone           
------------------------------
 Sat Mar 26 23:00:00 2011 UTC
(1 row)

SELECT '2011-03-27 02:00:01'::timestamp AT TIME ZONE 'Europe/Moscow';
           timezone           
------------------------------
 Sat Mar 26 23:00:01 2011 UTC
(1 row)

SELECT '2011-03-27 02:59:59'::timestamp AT TIME ZONE 'Europe/Moscow';
           timezone           
------------------------------
 Sat Mar 26 23:59:59 2011 UTC
(1 row)

SELECT '2011-03-27 03:00:00'::timestamp AT TIME ZONE 'Europe/Moscow';
           timezone           
------------------------------
 Sat Mar 26 23:00:00 2011 UTC
(1 row)

SELECT '2011-03-27 03:00:01'::timestamp AT TIME ZONE 'Europe/Moscow';
           timezone           
------------------------------
 Sat Mar 26 23:00:01 2011 UTC
(1 row)

SELECT '2011-03-27 04:00:00'::timestamp AT TIME ZONE 'Europe/Moscow';
           timezone           
------------------------------
 Sun Mar 27 00:00:00 2011 UTC
(1 row)

SELECT '2011-03-27 00:00:00'::timestamp AT TIME ZONE 'MSK';
           timezone           
------------------------------
 Sat Mar 26 21:00:00 2011 UTC
(1 row)

SELECT '2011-03-27 01:00:00'::timestamp AT TIME ZONE 'MSK';
           timezone           
------------------------------
 Sat Mar 26 22:00:00 2011 UTC
(1 row)

SELECT '2011-03-27 01:59:59'::timestamp AT TIME ZONE 'MSK';
           timezone           
------------------------------
 Sat Mar 26 22:59:59 2011 UTC
(1 row)

SELECT '2011-03-27 02:00:00'::timestamp AT TIME ZONE 'MSK';
           timezone           
------------------------------
 Sat Mar 26 22:00:00 2011 UTC
(1 row)

SELECT '2011-03-27 02:00:01'::timestamp AT TIME ZONE 'MSK';
           timezone           
------------------------------
 Sat Mar 26 22:00:01 2011 UTC
(1 row)

SELECT '2011-03-27 02:59:59'::timestamp AT TIME ZONE 'MSK';
           timezone           
------------------------------
 Sat Mar 26 22:59:59 2011 UTC
(1 row)

SELECT '2011-03-27 03:00:00'::timestamp AT TIME ZONE 'MSK';
           timezone           
------------------------------
 Sat Mar 26 23:00:00 2011 UTC
(1 row)

SELECT '2011-03-27 03:00:01'::timestamp AT TIME ZONE 'MSK';
           timezone           
------------------------------
 Sat Mar 26 23:00:01 2011 UTC
(1 row)

SELECT '2011-03-27 04:00:00'::timestamp AT TIME ZONE 'MSK';
           timezone           
------------------------------
 Sun Mar 27 00:00:00 2011 UTC
(1 row)

SELECT '2007-12-09 02:00:00'::timestamp AT TIME ZONE 'America/Caracas';
           timezone           
------------------------------
 Sun Dec 09 06:00:00 2007 UTC
(1 row)

SELECT '2007-12-09 02:29:59'::timestamp AT TIME ZONE 'America/Caracas';
           timezone           
------------------------------
 Sun Dec 09 06:29:59 2007 UTC
(1 row)

SELECT '2007-12-09 02:30:00'::timestamp AT TIME ZONE 'America/Caracas';
           timezone           
------------------------------
 Sun Dec 09 07:00:00 2007 UTC
(1 row)

SELECT '2007-12-09 02:30:01'::timestamp AT TIME ZONE 'America/Caracas';
           timezone           
------------------------------
 Sun Dec 09 07:00:01 2007 UTC
(1 row)

SELECT '2007-12-09 02:59:59'::timestamp AT TIME ZONE 'America/Caracas';
           timezone           
------------------------------
 Sun Dec 09 07:29:59 2007 UTC
(1 row)

SELECT '2007-12-09 03:00:00'::timestamp AT TIME ZONE 'America/Caracas';
           timezone           
------------------------------
 Sun Dec 09 07:30:00 2007 UTC
(1 row)

SELECT '2007-12-09 03:00:01'::timestamp AT TIME ZONE 'America/Caracas';
           timezone           
------------------------------
 Sun Dec 09 07:30:01 2007 UTC
(1 row)

SELECT '2007-12-09 04:00:00'::timestamp AT TIME ZONE 'America/Caracas';
           timezone           
------------------------------
 Sun Dec 09 08:30:00 2007 UTC
(1 row)

SELECT '2007-12-09 02:00:00'::timestamp AT TIME ZONE 'VET';
           timezone           
------------------------------
 Sun Dec 09 06:00:00 2007 UTC
(1 row)

SELECT '2007-12-09 02:29:59'::timestamp AT TIME ZONE 'VET';
           timezone           
------------------------------
 Sun Dec 09 06:29:59 2007 UTC
(1 row)

SELECT '2007-12-09 02:30:00'::timestamp AT TIME ZONE 'VET';
           timezone           
------------------------------
 Sun Dec 09 07:00:00 2007 UTC
(1 row)

SELECT '2007-12-09 02:30:01'::timestamp AT TIME ZONE 'VET';
           timezone           
------------------------------
 Sun Dec 09 07:00:01 2007 UTC
(1 row)

SELECT '2007-12-09 02:59:59'::timestamp AT TIME ZONE 'VET';
           timezone           
------------------------------
 Sun Dec 09 07:29:59 2007 UTC
(1 row)

SELECT '2007-12-09 03:00:00'::timestamp AT TIME ZONE 'VET';
           timezone           
------------------------------
 Sun Dec 09 07:30:00 2007 UTC
(1 row)

SELECT '2007-12-09 03:00:01'::timestamp AT TIME ZONE 'VET';
           timezone           
------------------------------
 Sun Dec 09 07:30:01 2007 UTC
(1 row)

SELECT '2007-12-09 04:00:00'::timestamp AT TIME ZONE 'VET';
           timezone           
------------------------------
 Sun Dec 09 08:30:00 2007 UTC
(1 row)

SELECT make_timestamptz(2007, 12, 9, 2, 0, 0, 'VET');
       make_timestamptz       
------------------------------
 Sun Dec 09 06:00:00 2007 UTC
(1 row)

SELECT make_timestamptz(2007, 12, 9, 3, 0, 0, 'VET');
       make_timestamptz       
------------------------------
 Sun Dec 09 07:30:00 2007 UTC
(1 row)

SET TimeZone to 'Europe/Moscow';
SELECT '2011-03-26 21:00:00 UTC'::timestamptz;
         timestamptz          
------------------------------
 Sun Mar 27 00:00:00 2011 MSK
(1 row)

SELECT '2011-03-26 22:00:00 UTC'::timestamptz;
         timestamptz          
------------------------------
 Sun Mar 27 01:00:00 2011 MSK
(1 row)

SELECT '2011-03-26 22:59:59 UTC'::timestamptz;
         timestamptz          
------------------------------
 Sun Mar 27 01:59:59 2011 MSK
(1 row)

SELECT '2011-03-26 23:00:00 UTC'::timestamptz;
         timestamptz          
------------------------------
 Sun Mar 27 03:00:00 2011 MSK
(1 row)

SELECT '2011-03-26 23:00:01 UTC'::timestamptz;
         timestamptz          
------------------------------
 Sun Mar 27 03:00:01 2011 MSK
(1 row)

SELECT '2011-03-26 23:59:59 UTC'::timestamptz;
         timestamptz          
------------------------------
 Sun Mar 27 03:59:59 2011 MSK
(1 row)

SELECT '2011-03-27 00:00:00 UTC'::timestamptz;
         timestamptz          
------------------------------
 Sun Mar 27 04:00:00 2011 MSK
(1 row)

SET TimeZone to 'America/Caracas';
SELECT '2007-12-09 06:00:00 UTC'::timestamptz;
         timestamptz          
------------------------------
 Sun Dec 09 02:00:00 2007 VET
(1 row)

SELECT '2007-12-09 06:30:00 UTC'::timestamptz;
         timestamptz          
------------------------------
 Sun Dec 09 02:30:00 2007 VET
(1 row)

SELECT '2007-12-09 06:59:59 UTC'::timestamptz;
         timestamptz          
------------------------------
 Sun Dec 09 02:59:59 2007 VET
(1 row)

SELECT '2007-12-09 07:00:00 UTC'::timestamptz;
         timestamptz          
------------------------------
 Sun Dec 09 02:30:00 2007 VET
(1 row)

SELECT '2007-12-09 07:00:01 UTC'::timestamptz;
         timestamptz          
------------------------------
 Sun Dec 09 02:30:01 2007 VET
(1 row)

SELECT '2007-12-09 07:29:59 UTC'::timestamptz;
         timestamptz          
------------------------------
 Sun Dec 09 02:59:59 2007 VET
(1 row)

SELECT '2007-12-09 07:30:00 UTC'::timestamptz;
         timestamptz          
------------------------------
 Sun Dec 09 03:00:00 2007 VET
(1 row)

RESET TimeZone;
SELECT '2011-03-26 21:00:00 UTC'::timestamptz AT TIME ZONE 'Europe/Moscow';
         timezone         
--------------------------
 Sun Mar 27 00:00:00 2011
(1 row)

SELECT '2011-03-26 22:00:00 UTC'::timestamptz AT TIME ZONE 'Europe/Moscow';
         timezone         
--------------------------
 Sun Mar 27 01:00:00 2011
(1 row)

SELECT '2011-03-26 22:59:59 UTC'::timestamptz AT TIME ZONE 'Europe/Moscow';
         timezone         
--------------------------
 Sun Mar 27 01:59:59 2011
(1 row)

SELECT '2011-03-26 23:00:00 UTC'::timestamptz AT TIME ZONE 'Europe/Moscow';
         timezone         
--------------------------
 Sun Mar 27 03:00:00 2011
(1 row)

SELECT '2011-03-26 23:00:01 UTC'::timestamptz AT TIME ZONE 'Europe/Moscow';
         timezone         
--------------------------
 Sun Mar 27 03:00:01 2011
(1 row)

SELECT '2011-03-26 23:59:59 UTC'::timestamptz AT TIME ZONE 'Europe/Moscow';
         timezone         
--------------------------
 Sun Mar 27 03:59:59 2011
(1 row)

SELECT '2011-03-27 00:00:00 UTC'::timestamptz AT TIME ZONE 'Europe/Moscow';
         timezone         
--------------------------
 Sun Mar 27 04:00:00 2011
(1 row)

SELECT '2007-12-09 06:00:00 UTC'::timestamptz AT TIME ZONE 'America/Caracas';
         timezone         
--------------------------
 Sun Dec 09 02:00:00 2007
(1 row)

SELECT '2007-12-09 06:30:00 UTC'::timestamptz AT TIME ZONE 'America/Caracas';
         timezone         
--------------------------
 Sun Dec 09 02:30:00 2007
(1 row)

SELECT '2007-12-09 06:59:59 UTC'::timestamptz AT TIME ZONE 'America/Caracas';
         timezone         
--------------------------
 Sun Dec 09 02:59:59 2007
(1 row)

SELECT '2007-12-09 07:00:00 UTC'::timestamptz AT TIME ZONE 'America/Caracas';
         timezone         
--------------------------
 Sun Dec 09 02:30:00 2007
(1 row)

SELECT '2007-12-09 07:00:01 UTC'::timestamptz AT TIME ZONE 'America/Caracas';
         timezone         
--------------------------
 Sun Dec 09 02:30:01 2007
(1 row)

SELECT '2007-12-09 07:29:59 UTC'::timestamptz AT TIME ZONE 'America/Caracas';
         timezone         
--------------------------
 Sun Dec 09 02:59:59 2007
(1 row)

SELECT '2007-12-09 07:30:00 UTC'::timestamptz AT TIME ZONE 'America/Caracas';
         timezone         
--------------------------
 Sun Dec 09 03:00:00 2007
(1 row)

SELECT '2011-03-26 21:00:00 UTC'::timestamptz AT TIME ZONE 'MSK';
         timezone         
--------------------------
 Sun Mar 27 00:00:00 2011
(1 row)

SELECT '2011-03-26 22:00:00 UTC'::timestamptz AT TIME ZONE 'MSK';
         timezone         
--------------------------
 Sun Mar 27 01:00:00 2011
(1 row)

SELECT '2011-03-26 22:59:59 UTC'::timestamptz AT TIME ZONE 'MSK';
         timezone         
--------------------------
 Sun Mar 27 01:59:59 2011
(1 row)

SELECT '2011-03-26 23:00:00 UTC'::timestamptz AT TIME ZONE 'MSK';
         timezone         
--------------------------
 Sun Mar 27 03:00:00 2011
(1 row)

SELECT '2011-03-26 23:00:01 UTC'::timestamptz AT TIME ZONE 'MSK';
         timezone         
--------------------------
 Sun Mar 27 03:00:01 2011
(1 row)

SELECT '2011-03-26 23:59:59 UTC'::timestamptz AT TIME ZONE 'MSK';
         timezone         
--------------------------
 Sun Mar 27 03:59:59 2011
(1 row)

SELECT '2011-03-27 00:00:00 UTC'::timestamptz AT TIME ZONE 'MSK';
         timezone         
--------------------------
 Sun Mar 27 04:00:00 2011
(1 row)

SELECT '2007-12-09 06:00:00 UTC'::timestamptz AT TIME ZONE 'VET';
         timezone         
--------------------------
 Sun Dec 09 02:00:00 2007
(1 row)

SELECT '2007-12-09 06:30:00 UTC'::timestamptz AT TIME ZONE 'VET';
         timezone         
--------------------------
 Sun Dec 09 02:30:00 2007
(1 row)

SELECT '2007-12-09 06:59:59 UTC'::timestamptz AT TIME ZONE 'VET';
         timezone         
--------------------------
 Sun Dec 09 02:59:59 2007
(1 row)

SELECT '2007-12-09 07:00:00 UTC'::timestamptz AT TIME ZONE 'VET';
         timezone         
--------------------------
 Sun Dec 09 02:30:00 2007
(1 row)

SELECT '2007-12-09 07:00:01 UTC'::timestamptz AT TIME ZONE 'VET';
         timezone         
--------------------------
 Sun Dec 09 02:30:01 2007
(1 row)

SELECT '2007-12-09 07:29:59 UTC'::timestamptz AT TIME ZONE 'VET';
         timezone         
--------------------------
 Sun Dec 09 02:59:59 2007
(1 row)

SELECT '2007-12-09 07:30:00 UTC'::timestamptz AT TIME ZONE 'VET';
         timezone         
--------------------------
 Sun Dec 09 03:00:00 2007
(1 row)

